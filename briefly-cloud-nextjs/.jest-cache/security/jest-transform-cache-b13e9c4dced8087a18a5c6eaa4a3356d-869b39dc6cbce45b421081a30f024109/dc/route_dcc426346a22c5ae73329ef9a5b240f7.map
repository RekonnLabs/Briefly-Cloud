{"version":3,"names":["GET","cov_26ga5kg63d","f","s","POST","chunkCreationSchema","_zod","z","object","text","string","min","fileId","fileName","mimeType","strategy","enum","optional","default","maxChunkSize","number","max","minChunkSize","overlap","preserveStructure","boolean","respectBoundaries","saveToDatabase","createChunksHandler","request","context","user","b","_apiutils","ApiResponse","unauthorized","body","json","validation","safeParse","success","badRequest","data","chunker","_documentchunker","DocumentChunker","chunks","createChunks","id","storedChunks","storeDocumentChunks","supabase","_supabase","supabaseAdmin","from","update","processed","processing_status","metadata","chunk_count","length","chunking_strategy","max_chunk_size","processed_at","Date","toISOString","updated_at","eq","stats","getChunkingStats","_logger","logApiUsage","file_id","text_length","saved_to_database","config","error","console","Error","name","internalError","getChunkingInfoHandler","_request","_context","capabilities","strategies","paragraph","description","default_config","DEFAULT_CHUNKING_CONFIGS","best_for","pros","cons","sentence","fixed","sliding","semantic","status","configuration_options","recommended","note","performance_guidelines","chunk_count_estimates","processing_time","memory_usage","limitations","max_text_length","max_chunks_per_document","supported_languages","batch_processing","version","last_updated","_apimiddleware","createProtectedApiHandler","rateLimit","_ratelimit","rateLimitConfigs","general","maxRequests","logging","enabled","includeBody"],"sources":["R:\\Apps\\Briefly_Cloud\\briefly-cloud-nextjs\\src\\app\\api\\chunks\\route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { createProtectedApiHandler, ApiContext } from '@/app/lib/api-middleware'\r\nimport { ApiResponse } from '@/app/lib/api-utils'\r\nimport { rateLimitConfigs } from '@/app/lib/rate-limit'\r\nimport { supabaseAdmin } from '@/app/lib/supabase'\r\nimport { logApiUsage } from '@/app/lib/logger'\r\nimport { \r\n  DocumentChunker, \r\n  storeDocumentChunks, \r\n  getChunkingStats,\r\n  DEFAULT_CHUNKING_CONFIGS \r\n} from '@/app/lib/document-chunker'\r\nimport { z } from 'zod'\r\n\r\n// Validation schemas\r\nconst chunkCreationSchema = z.object({\r\n  text: z.string().min(1),\r\n  fileId: z.string(),\r\n  fileName: z.string(),\r\n  mimeType: z.string(),\r\n  strategy: z.enum(['paragraph', 'sentence', 'fixed', 'semantic', 'sliding']).optional().default('paragraph'),\r\n  maxChunkSize: z.number().min(100).max(5000).optional().default(1000),\r\n  minChunkSize: z.number().min(50).max(2000).optional(),\r\n  overlap: z.number().min(0).max(1000).optional(),\r\n  preserveStructure: z.boolean().optional(),\r\n  respectBoundaries: z.boolean().optional(),\r\n  saveToDatabase: z.boolean().optional().default(true),\r\n})\r\n\r\n// Note: fileChunkingSchema defined but not used in this route\r\n// const fileChunkingSchema = z.object({\r\n//   fileId: z.string(),\r\n//   strategy: z.enum(['paragraph', 'sentence', 'fixed', 'semantic', 'sliding']).optional().default('paragraph'),\r\n//   maxChunkSize: z.number().min(100).max(5000).optional().default(1000),\r\n//   minChunkSize: z.number().min(50).max(2000).optional(),\r\n//   overlap: z.number().min(0).max(1000).optional(),\r\n//   preserveStructure: z.boolean().optional(),\r\n//   respectBoundaries: z.boolean().optional(),\r\n//   saveToDatabase: z.boolean().optional().default(true),\r\n//   forceReprocess: z.boolean().optional().default(false),\r\n// })\r\n\r\n// POST /api/chunks - Create chunks from text\r\nasync function createChunksHandler(request: Request, context: ApiContext): Promise<NextResponse> {\r\n  const { user } = context\r\n  \r\n  if (!user) {\r\n    return ApiResponse.unauthorized('User not authenticated')\r\n  }\r\n  \r\n  try {\r\n    const body = await request.json()\r\n    const validation = chunkCreationSchema.safeParse(body)\r\n    \r\n    if (!validation.success) {\r\n      return ApiResponse.badRequest('Invalid request data')\r\n    }\r\n    \r\n    const {\r\n      text,\r\n      fileId,\r\n      fileName,\r\n      mimeType,\r\n      strategy,\r\n      maxChunkSize,\r\n      minChunkSize,\r\n      overlap,\r\n      preserveStructure,\r\n      respectBoundaries,\r\n      saveToDatabase,\r\n    } = validation.data\r\n    \r\n    // Create chunker with configuration\r\n    const chunker = new DocumentChunker({\r\n      strategy,\r\n      maxChunkSize,\r\n      minChunkSize,\r\n      overlap,\r\n      preserveStructure,\r\n      respectBoundaries,\r\n    })\r\n    \r\n    // Create chunks\r\n    const chunks = chunker.createChunks(text, fileId, fileName, mimeType, user.id)\r\n    \r\n    // Store in database if requested\r\n    let storedChunks = null\r\n    if (saveToDatabase) {\r\n      storedChunks = await storeDocumentChunks(chunks, user.id, fileId)\r\n      \r\n      // Update file metadata to mark as processed\r\n      const supabase = supabaseAdmin\r\n      \r\n      await supabase\r\n        .from('file_metadata')\r\n        .update({\r\n          processed: true,\r\n          processing_status: 'completed',\r\n          metadata: {\r\n            chunk_count: chunks.length,\r\n            chunking_strategy: strategy,\r\n            max_chunk_size: maxChunkSize,\r\n            processed_at: new Date().toISOString(),\r\n          },\r\n          updated_at: new Date().toISOString(),\r\n        })\r\n        .eq('id', fileId)\r\n        .eq('user_id', user.id)\r\n    }\r\n    \r\n    // Get chunking statistics\r\n    const stats = getChunkingStats(chunks)\r\n    \r\n    // Log usage\r\n    logApiUsage(user.id, '/api/chunks', 'chunk_creation', {\r\n      file_id: fileId,\r\n      strategy,\r\n      chunk_count: chunks.length,\r\n      text_length: text.length,\r\n      max_chunk_size: maxChunkSize,\r\n      saved_to_database: saveToDatabase,\r\n    })\r\n    \r\n    return ApiResponse.success({\r\n      chunks: storedChunks || chunks,\r\n      stats,\r\n      config: {\r\n        strategy,\r\n        maxChunkSize,\r\n        minChunkSize,\r\n        overlap,\r\n        preserveStructure,\r\n        respectBoundaries,\r\n      },\r\n      saved_to_database: saveToDatabase,\r\n    }, 'Chunks created successfully')\r\n    \r\n  } catch (error) {\r\n    console.error('Create chunks handler error:', error)\r\n    \r\n    if (error instanceof Error && error.name === 'AppError') {\r\n      throw error\r\n    }\r\n    \r\n    return ApiResponse.internalError('Failed to create chunks')\r\n  }\r\n}\r\n\r\n// GET /api/chunks - Get chunking capabilities and configurations\r\nasync function getChunkingInfoHandler(_request: Request, _context: ApiContext): Promise<NextResponse> {\r\n  try {\r\n    const capabilities = {\r\n      strategies: {\r\n        paragraph: {\r\n          name: 'Paragraph-based',\r\n          description: 'Split text by paragraph boundaries, preserving document structure',\r\n          default_config: DEFAULT_CHUNKING_CONFIGS.paragraph,\r\n          best_for: ['documents', 'articles', 'reports'],\r\n          pros: ['Preserves structure', 'Natural boundaries', 'Good for most documents'],\r\n          cons: ['Variable chunk sizes', 'May create very large chunks'],\r\n        },\r\n        sentence: {\r\n          name: 'Sentence-based',\r\n          description: 'Split text by sentence boundaries for more granular chunks',\r\n          default_config: DEFAULT_CHUNKING_CONFIGS.sentence,\r\n          best_for: ['detailed_analysis', 'qa_systems', 'precise_retrieval'],\r\n          pros: ['Granular control', 'Natural language boundaries', 'Good for Q&A'],\r\n          cons: ['More chunks', 'May lose context', 'Slower processing'],\r\n        },\r\n        fixed: {\r\n          name: 'Fixed-size',\r\n          description: 'Create chunks of approximately equal size',\r\n          default_config: DEFAULT_CHUNKING_CONFIGS.fixed,\r\n          best_for: ['consistent_processing', 'memory_constraints', 'batch_operations'],\r\n          pros: ['Predictable sizes', 'Consistent processing', 'Memory efficient'],\r\n          cons: ['May break sentences', 'Less natural boundaries', 'Context loss'],\r\n        },\r\n        sliding: {\r\n          name: 'Sliding window',\r\n          description: 'Create overlapping chunks to preserve context across boundaries',\r\n          default_config: DEFAULT_CHUNKING_CONFIGS.sliding,\r\n          best_for: ['context_preservation', 'search_applications', 'embeddings'],\r\n          pros: ['Preserves context', 'No information loss', 'Better for search'],\r\n          cons: ['More chunks', 'Storage overhead', 'Processing complexity'],\r\n        },\r\n        semantic: {\r\n          name: 'Semantic boundaries',\r\n          description: 'Split based on semantic meaning (future enhancement)',\r\n          default_config: DEFAULT_CHUNKING_CONFIGS.semantic,\r\n          best_for: ['advanced_analysis', 'topic_modeling', 'content_understanding'],\r\n          pros: ['Intelligent boundaries', 'Topic coherence', 'Better embeddings'],\r\n          cons: ['Complex processing', 'Slower performance', 'Not yet implemented'],\r\n          status: 'coming_soon',\r\n        },\r\n      },\r\n      \r\n      configuration_options: {\r\n        maxChunkSize: {\r\n          description: 'Maximum characters per chunk',\r\n          min: 100,\r\n          max: 5000,\r\n          default: 1000,\r\n          recommended: {\r\n            'short_documents': 500,\r\n            'medium_documents': 1000,\r\n            'long_documents': 1500,\r\n            'embeddings': 1000,\r\n            'search': 800,\r\n          },\r\n        },\r\n        minChunkSize: {\r\n          description: 'Minimum characters per chunk (prevents tiny chunks)',\r\n          min: 50,\r\n          max: 2000,\r\n          default: 100,\r\n        },\r\n        overlap: {\r\n          description: 'Character overlap for sliding window strategy',\r\n          min: 0,\r\n          max: 1000,\r\n          default: 200,\r\n          note: 'Only applies to sliding window strategy',\r\n        },\r\n        preserveStructure: {\r\n          description: 'Try to preserve document structure (paragraphs, sections)',\r\n          default: true,\r\n          recommended: true,\r\n        },\r\n        respectBoundaries: {\r\n          description: 'Avoid breaking words or sentences when possible',\r\n          default: true,\r\n          recommended: true,\r\n        },\r\n      },\r\n      \r\n      performance_guidelines: {\r\n        chunk_count_estimates: {\r\n          '1000_chars': '~1 chunk',\r\n          '5000_chars': '3-5 chunks',\r\n          '10000_chars': '8-12 chunks',\r\n          '50000_chars': '40-60 chunks',\r\n        },\r\n        processing_time: {\r\n          'paragraph': 'Fast (~10ms per 1000 chars)',\r\n          'sentence': 'Medium (~20ms per 1000 chars)',\r\n          'fixed': 'Fast (~5ms per 1000 chars)',\r\n          'sliding': 'Medium (~15ms per 1000 chars)',\r\n          'semantic': 'Slow (~100ms per 1000 chars, when available)',\r\n        },\r\n        memory_usage: {\r\n          'paragraph': 'Low',\r\n          'sentence': 'Medium',\r\n          'fixed': 'Low',\r\n          'sliding': 'High (due to overlap)',\r\n          'semantic': 'High',\r\n        },\r\n      },\r\n      \r\n      limitations: {\r\n        max_text_length: 1000000, // 1MB of text\r\n        max_chunks_per_document: 1000,\r\n        supported_languages: ['English (primary)', 'Other languages (basic support)'],\r\n        batch_processing: 'Up to 10 documents per request',\r\n      },\r\n      \r\n      version: '1.0.0',\r\n      last_updated: new Date().toISOString(),\r\n    }\r\n    \r\n    return ApiResponse.success(capabilities)\r\n    \r\n  } catch (error) {\r\n    console.error('Get chunking info handler error:', error)\r\n    return ApiResponse.internalError('Failed to get chunking information')\r\n  }\r\n}\r\n\r\n// Export handlers with middleware\r\nexport const POST = createProtectedApiHandler(createChunksHandler, {\r\n  rateLimit: {\r\n    ...rateLimitConfigs.general,\r\n    maxRequests: 50, // More restrictive for processing operations\r\n  },\r\n  logging: {\r\n    enabled: true,\r\n    includeBody: true,\r\n  },\r\n})\r\n\r\nexport const GET = createProtectedApiHandler(getChunkingInfoHandler, {\r\n  rateLimit: rateLimitConfigs.general,\r\n  logging: {\r\n    enabled: true,\r\n    includeBody: false,\r\n  },\r\n})"],"mappings":"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","ignoreList":[]}