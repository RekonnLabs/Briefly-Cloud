eb43c5cfe54a0cf775a2d0ef97f41e3a
"use strict";

/* istanbul ignore next */
function cov_1lthomjlde() {
  var path = "R:\\Apps\\Briefly_Cloud\\briefly-cloud-nextjs\\src\\app\\api\\extract\\batch\\route.ts";
  var hash = "ff444478db98c491d898372e0b71ae95f5ac88e3";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "R:\\Apps\\Briefly_Cloud\\briefly-cloud-nextjs\\src\\app\\api\\extract\\batch\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 20
        }
      },
      "3": {
        start: {
          line: 11,
          column: 23
        },
        end: {
          line: 11,
          column: 61
        }
      },
      "4": {
        start: {
          line: 12,
          column: 18
        },
        end: {
          line: 12,
          column: 51
        }
      },
      "5": {
        start: {
          line: 13,
          column: 19
        },
        end: {
          line: 13,
          column: 53
        }
      },
      "6": {
        start: {
          line: 14,
          column: 18
        },
        end: {
          line: 14,
          column: 50
        }
      },
      "7": {
        start: {
          line: 15,
          column: 16
        },
        end: {
          line: 15,
          column: 46
        }
      },
      "8": {
        start: {
          line: 16,
          column: 27
        },
        end: {
          line: 16,
          column: 69
        }
      },
      "9": {
        start: {
          line: 17,
          column: 13
        },
        end: {
          line: 17,
          column: 27
        }
      },
      "10": {
        start: {
          line: 19,
          column: 30
        },
        end: {
          line: 27,
          column: 2
        }
      },
      "11": {
        start: {
          line: 30,
          column: 21
        },
        end: {
          line: 30,
          column: 28
        }
      },
      "12": {
        start: {
          line: 31,
          column: 4
        },
        end: {
          line: 33,
          column: 5
        }
      },
      "13": {
        start: {
          line: 32,
          column: 8
        },
        end: {
          line: 32,
          column: 76
        }
      },
      "14": {
        start: {
          line: 34,
          column: 4
        },
        end: {
          line: 199,
          column: 5
        }
      },
      "15": {
        start: {
          line: 35,
          column: 21
        },
        end: {
          line: 35,
          column: 41
        }
      },
      "16": {
        start: {
          line: 36,
          column: 27
        },
        end: {
          line: 36,
          column: 64
        }
      },
      "17": {
        start: {
          line: 37,
          column: 8
        },
        end: {
          line: 39,
          column: 9
        }
      },
      "18": {
        start: {
          line: 38,
          column: 12
        },
        end: {
          line: 38,
          column: 76
        }
      },
      "19": {
        start: {
          line: 40,
          column: 38
        },
        end: {
          line: 40,
          column: 53
        }
      },
      "20": {
        start: {
          line: 41,
          column: 25
        },
        end: {
          line: 41,
          column: 48
        }
      },
      "21": {
        start: {
          line: 43,
          column: 51
        },
        end: {
          line: 43,
          column: 141
        }
      },
      "22": {
        start: {
          line: 44,
          column: 8
        },
        end: {
          line: 47,
          column: 9
        }
      },
      "23": {
        start: {
          line: 45,
          column: 12
        },
        end: {
          line: 45,
          column: 60
        }
      },
      "24": {
        start: {
          line: 46,
          column: 12
        },
        end: {
          line: 46,
          column: 80
        }
      },
      "25": {
        start: {
          line: 48,
          column: 8
        },
        end: {
          line: 50,
          column: 9
        }
      },
      "26": {
        start: {
          line: 49,
          column: 12
        },
        end: {
          line: 49,
          column: 68
        }
      },
      "27": {
        start: {
          line: 51,
          column: 24
        },
        end: {
          line: 63,
          column: 9
        }
      },
      "28": {
        start: {
          line: 65,
          column: 8
        },
        end: {
          line: 181,
          column: 9
        }
      },
      "29": {
        start: {
          line: 66,
          column: 12
        },
        end: {
          line: 180,
          column: 13
        }
      },
      "30": {
        start: {
          line: 68,
          column: 16
        },
        end: {
          line: 75,
          column: 17
        }
      },
      "31": {
        start: {
          line: 69,
          column: 20
        },
        end: {
          line: 73,
          column: 23
        }
      },
      "32": {
        start: {
          line: 74,
          column: 20
        },
        end: {
          line: 74,
          column: 29
        }
      },
      "33": {
        start: {
          line: 77,
          column: 16
        },
        end: {
          line: 93,
          column: 17
        }
      },
      "34": {
        start: {
          line: 79,
          column: 53
        },
        end: {
          line: 81,
          column: 22
        }
      },
      "35": {
        start: {
          line: 82,
          column: 20
        },
        end: {
          line: 92,
          column: 21
        }
      },
      "36": {
        start: {
          line: 83,
          column: 24
        },
        end: {
          line: 90,
          column: 27
        }
      },
      "37": {
        start: {
          line: 91,
          column: 24
        },
        end: {
          line: 91,
          column: 33
        }
      },
      "38": {
        start: {
          line: 96,
          column: 16
        },
        end: {
          line: 114,
          column: 17
        }
      },
      "39": {
        start: {
          line: 97,
          column: 69
        },
        end: {
          line: 97,
          column: 129
        }
      },
      "40": {
        start: {
          line: 98,
          column: 20
        },
        end: {
          line: 105,
          column: 21
        }
      },
      "41": {
        start: {
          line: 99,
          column: 24
        },
        end: {
          line: 103,
          column: 27
        }
      },
      "42": {
        start: {
          line: 104,
          column: 24
        },
        end: {
          line: 104,
          column: 33
        }
      },
      "43": {
        start: {
          line: 106,
          column: 20
        },
        end: {
          line: 106,
          column: 75
        }
      },
      "44": {
        start: {
          line: 108,
          column: 20
        },
        end: {
          line: 112,
          column: 23
        }
      },
      "45": {
        start: {
          line: 113,
          column: 20
        },
        end: {
          line: 113,
          column: 29
        }
      },
      "46": {
        start: {
          line: 116,
          column: 41
        },
        end: {
          line: 116,
          column: 131
        }
      },
      "47": {
        start: {
          line: 118,
          column: 29
        },
        end: {
          line: 118,
          column: 33
        }
      },
      "48": {
        start: {
          line: 119,
          column: 16
        },
        end: {
          line: 121,
          column: 17
        }
      },
      "49": {
        start: {
          line: 120,
          column: 20
        },
        end: {
          line: 120,
          column: 151
        }
      },
      "50": {
        start: {
          line: 123,
          column: 16
        },
        end: {
          line: 157,
          column: 17
        }
      },
      "51": {
        start: {
          line: 124,
          column: 20
        },
        end: {
          line: 156,
          column: 21
        }
      },
      "52": {
        start: {
          line: 126,
          column: 24
        },
        end: {
          line: 126,
          column: 95
        }
      },
      "53": {
        start: {
          line: 128,
          column: 42
        },
        end: {
          line: 134,
          column: 31
        }
      },
      "54": {
        start: {
          line: 128,
          column: 63
        },
        end: {
          line: 134,
          column: 29
        }
      },
      "55": {
        start: {
          line: 135,
          column: 24
        },
        end: {
          line: 135,
          column: 81
        }
      },
      "56": {
        start: {
          line: 137,
          column: 24
        },
        end: {
          line: 152,
          column: 45
        }
      },
      "57": {
        start: {
          line: 154,
          column: 24
        },
        end: {
          line: 154,
          column: 91
        }
      },
      "58": {
        start: {
          line: 159,
          column: 30
        },
        end: {
          line: 159,
          column: 90
        }
      },
      "59": {
        start: {
          line: 160,
          column: 16
        },
        end: {
          line: 171,
          column: 19
        }
      },
      "60": {
        start: {
          line: 172,
          column: 16
        },
        end: {
          line: 172,
          column: 98
        }
      },
      "61": {
        start: {
          line: 174,
          column: 16
        },
        end: {
          line: 174,
          column: 74
        }
      },
      "62": {
        start: {
          line: 175,
          column: 16
        },
        end: {
          line: 179,
          column: 19
        }
      },
      "63": {
        start: {
          line: 183,
          column: 8
        },
        end: {
          line: 183,
          column: 67
        }
      },
      "64": {
        start: {
          line: 184,
          column: 8
        },
        end: {
          line: 184,
          column: 63
        }
      },
      "65": {
        start: {
          line: 185,
          column: 8
        },
        end: {
          line: 185,
          column: 61
        }
      },
      "66": {
        start: {
          line: 187,
          column: 8
        },
        end: {
          line: 194,
          column: 11
        }
      },
      "67": {
        start: {
          line: 195,
          column: 8
        },
        end: {
          line: 195,
          column: 212
        }
      },
      "68": {
        start: {
          line: 197,
          column: 8
        },
        end: {
          line: 197,
          column: 64
        }
      },
      "69": {
        start: {
          line: 198,
          column: 8
        },
        end: {
          line: 198,
          column: 89
        }
      },
      "70": {
        start: {
          line: 201,
          column: 13
        },
        end: {
          line: 210,
          column: 2
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "batchExtractionHandler",
        decl: {
          start: {
            line: 29,
            column: 15
          },
          end: {
            line: 29,
            column: 37
          }
        },
        loc: {
          start: {
            line: 29,
            column: 56
          },
          end: {
            line: 200,
            column: 1
          }
        },
        line: 29
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 128,
            column: 53
          },
          end: {
            line: 128,
            column: 54
          }
        },
        loc: {
          start: {
            line: 128,
            column: 63
          },
          end: {
            line: 134,
            column: 29
          }
        },
        line: 128
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 31,
            column: 4
          },
          end: {
            line: 33,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 31,
            column: 4
          },
          end: {
            line: 33,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 31
      },
      "1": {
        loc: {
          start: {
            line: 37,
            column: 8
          },
          end: {
            line: 39,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 37,
            column: 8
          },
          end: {
            line: 39,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 37
      },
      "2": {
        loc: {
          start: {
            line: 44,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 44,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 44
      },
      "3": {
        loc: {
          start: {
            line: 48,
            column: 8
          },
          end: {
            line: 50,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 48,
            column: 8
          },
          end: {
            line: 50,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 48
      },
      "4": {
        loc: {
          start: {
            line: 48,
            column: 12
          },
          end: {
            line: 48,
            column: 40
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 48,
            column: 12
          },
          end: {
            line: 48,
            column: 18
          }
        }, {
          start: {
            line: 48,
            column: 22
          },
          end: {
            line: 48,
            column: 40
          }
        }],
        line: 48
      },
      "5": {
        loc: {
          start: {
            line: 68,
            column: 16
          },
          end: {
            line: 75,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 68,
            column: 16
          },
          end: {
            line: 75,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 68
      },
      "6": {
        loc: {
          start: {
            line: 77,
            column: 16
          },
          end: {
            line: 93,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 77,
            column: 16
          },
          end: {
            line: 93,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 77
      },
      "7": {
        loc: {
          start: {
            line: 77,
            column: 20
          },
          end: {
            line: 77,
            column: 61
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 77,
            column: 20
          },
          end: {
            line: 77,
            column: 34
          }
        }, {
          start: {
            line: 77,
            column: 38
          },
          end: {
            line: 77,
            column: 61
          }
        }],
        line: 77
      },
      "8": {
        loc: {
          start: {
            line: 82,
            column: 20
          },
          end: {
            line: 92,
            column: 21
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 82,
            column: 20
          },
          end: {
            line: 92,
            column: 21
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 82
      },
      "9": {
        loc: {
          start: {
            line: 82,
            column: 24
          },
          end: {
            line: 82,
            column: 67
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 82,
            column: 24
          },
          end: {
            line: 82,
            column: 38
          }
        }, {
          start: {
            line: 82,
            column: 42
          },
          end: {
            line: 82,
            column: 67
          }
        }],
        line: 82
      },
      "10": {
        loc: {
          start: {
            line: 88,
            column: 41
          },
          end: {
            line: 88,
            column: 76
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 88,
            column: 41
          },
          end: {
            line: 88,
            column: 71
          }
        }, {
          start: {
            line: 88,
            column: 75
          },
          end: {
            line: 88,
            column: 76
          }
        }],
        line: 88
      },
      "11": {
        loc: {
          start: {
            line: 96,
            column: 16
          },
          end: {
            line: 114,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 96,
            column: 16
          },
          end: {
            line: 114,
            column: 17
          }
        }, {
          start: {
            line: 107,
            column: 23
          },
          end: {
            line: 114,
            column: 17
          }
        }],
        line: 96
      },
      "12": {
        loc: {
          start: {
            line: 96,
            column: 20
          },
          end: {
            line: 96,
            column: 57
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 96,
            column: 20
          },
          end: {
            line: 96,
            column: 44
          }
        }, {
          start: {
            line: 96,
            column: 48
          },
          end: {
            line: 96,
            column: 57
          }
        }],
        line: 96
      },
      "13": {
        loc: {
          start: {
            line: 98,
            column: 20
          },
          end: {
            line: 105,
            column: 21
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 98,
            column: 20
          },
          end: {
            line: 105,
            column: 21
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 98
      },
      "14": {
        loc: {
          start: {
            line: 98,
            column: 24
          },
          end: {
            line: 98,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 98,
            column: 24
          },
          end: {
            line: 98,
            column: 37
          }
        }, {
          start: {
            line: 98,
            column: 41
          },
          end: {
            line: 98,
            column: 50
          }
        }],
        line: 98
      },
      "15": {
        loc: {
          start: {
            line: 119,
            column: 16
          },
          end: {
            line: 121,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 119,
            column: 16
          },
          end: {
            line: 121,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 119
      },
      "16": {
        loc: {
          start: {
            line: 123,
            column: 16
          },
          end: {
            line: 157,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 123,
            column: 16
          },
          end: {
            line: 157,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 123
      },
      "17": {
        loc: {
          start: {
            line: 123,
            column: 20
          },
          end: {
            line: 123,
            column: 52
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 123,
            column: 20
          },
          end: {
            line: 123,
            column: 42
          }
        }, {
          start: {
            line: 123,
            column: 46
          },
          end: {
            line: 123,
            column: 52
          }
        }],
        line: 123
      },
      "18": {
        loc: {
          start: {
            line: 164,
            column: 33
          },
          end: {
            line: 164,
            column: 52
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 164,
            column: 33
          },
          end: {
            line: 164,
            column: 47
          }
        }, {
          start: {
            line: 164,
            column: 51
          },
          end: {
            line: 164,
            column: 52
          }
        }],
        line: 164
      },
      "19": {
        loc: {
          start: {
            line: 178,
            column: 27
          },
          end: {
            line: 178,
            column: 83
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 178,
            column: 52
          },
          end: {
            line: 178,
            column: 65
          }
        }, {
          start: {
            line: 178,
            column: 68
          },
          end: {
            line: 178,
            column: 83
          }
        }],
        line: 178
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0,
      "67": 0,
      "68": 0,
      "69": 0,
      "70": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0],
      "16": [0, 0],
      "17": [0, 0],
      "18": [0, 0],
      "19": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["R:\\Apps\\Briefly_Cloud\\briefly-cloud-nextjs\\src\\app\\api\\extract\\batch\\route.ts"],
      sourcesContent: ["import { NextResponse } from 'next/server'\r\nimport { createProtectedApiHandler, ApiContext } from '@/app/lib/api-middleware'\r\nimport { ApiResponse } from '@/app/lib/api-utils'\r\nimport { rateLimitConfigs } from '@/app/lib/rate-limit'\r\nimport { supabaseAdmin } from '@/app/lib/supabase'\r\nimport { logApiUsage } from '@/app/lib/logger'\r\nimport { \r\n  extractTextFromBuffer, \r\n  createTextChunks, \r\n  isSupportedMimeType,\r\n  getExtractionStats \r\n} from '@/app/lib/document-extractor'\r\nimport { z } from 'zod'\r\n\r\n// Validation schema\r\nconst batchExtractionSchema = z.object({\r\n  file_ids: z.array(z.string()).min(1).max(10), // Limit to 10 files at once\r\n  options: z.object({\r\n    createChunks: z.boolean().optional().default(true),\r\n    maxChunkSize: z.number().min(100).max(5000).optional().default(1000),\r\n    saveToDatabase: z.boolean().optional().default(true),\r\n    forceReprocess: z.boolean().optional().default(false),\r\n  }).optional().default({}),\r\n})\r\n\r\n// POST /api/extract/batch - Extract text from multiple files\r\nasync function batchExtractionHandler(request: Request, context: ApiContext): Promise<NextResponse> {\r\n  const { user } = context\r\n  \r\n  if (!user) {\r\n    return ApiResponse.unauthorized('User not authenticated')\r\n  }\r\n  \r\n  try {\r\n    const body = await request.json()\r\n    const validation = batchExtractionSchema.safeParse(body)\r\n    \r\n    if (!validation.success) {\r\n      return ApiResponse.badRequest('Invalid request data')\r\n    }\r\n    \r\n    const { file_ids, options } = validation.data\r\n    \r\n    const supabase = supabaseAdmin\r\n    \r\n    // Get files metadata\r\n    const { data: files, error: filesError } = await supabase\r\n      .from('file_metadata')\r\n      .select('*')\r\n      .eq('user_id', user.id)\r\n      .in('id', file_ids)\r\n    \r\n    if (filesError) {\r\n      console.error('Files fetch error:', filesError)\r\n      return ApiResponse.internalError('Failed to fetch files')\r\n    }\r\n    \r\n    if (!files || files.length === 0) {\r\n      return ApiResponse.notFound('No files found')\r\n    }\r\n    \r\n    const results = {\r\n      processed: [] as any[],\r\n      skipped: [] as any[],\r\n      failed: [] as any[],\r\n      summary: {\r\n        total_requested: file_ids.length,\r\n        total_found: files.length,\r\n        total_processed: 0,\r\n        total_skipped: 0,\r\n        total_failed: 0,\r\n        total_processing_time: 0,\r\n      },\r\n    }\r\n    \r\n    // Process each file\r\n    for (const file of files) {\r\n      try {\r\n        // Check if file type is supported\r\n        if (!isSupportedMimeType(file.mime_type)) {\r\n          results.skipped.push({\r\n            file_id: file.id,\r\n            file_name: file.name,\r\n            reason: `File type ${file.mime_type} is not supported for text extraction`,\r\n          })\r\n          continue\r\n        }\r\n        \r\n        // Check if already processed and not forcing reprocess\r\n        if (file.processed && !options.forceReprocess) {\r\n          // Get existing chunks\r\n          const { data: existingChunks } = await supabase\r\n            .from('document_chunks')\r\n            .select('*')\r\n            .eq('file_id', file.id)\r\n            .order('chunk_index', { ascending: true })\r\n          \r\n          if (existingChunks && existingChunks.length > 0) {\r\n            results.processed.push({\r\n              file_id: file.id,\r\n              file_name: file.name,\r\n              from_cache: true,\r\n              chunk_count: existingChunks.length,\r\n              text_length: file.metadata?.character_count || 0,\r\n              processing_time: 0,\r\n            })\r\n            continue\r\n          }\r\n        }\r\n        \r\n        // Download file\r\n        let fileBuffer: Buffer\r\n        \r\n        if (file.source === 'upload' && file.path) {\r\n          const { data: fileData, error: downloadError } = await supabase.storage\r\n            .from('documents')\r\n            .download(file.path)\r\n          \r\n          if (downloadError || !fileData) {\r\n            results.failed.push({\r\n              file_id: file.id,\r\n              file_name: file.name,\r\n              error: 'Failed to download file',\r\n            })\r\n            continue\r\n          }\r\n          \r\n          fileBuffer = Buffer.from(await fileData.arrayBuffer())\r\n        } else {\r\n          results.skipped.push({\r\n            file_id: file.id,\r\n            file_name: file.name,\r\n            reason: 'Cloud storage files not yet supported for batch extraction',\r\n          })\r\n          continue\r\n        }\r\n        \r\n        // Extract text\r\n        const extractionResult = await extractTextFromBuffer(fileBuffer, file.mime_type, file.name)\r\n        \r\n        // Create chunks\r\n        let chunks = null\r\n        if (options.createChunks) {\r\n          chunks = createTextChunks(\r\n            extractionResult.text,\r\n            file.id,\r\n            file.name,\r\n            file.mime_type,\r\n            options.maxChunkSize\r\n          )\r\n        }\r\n        \r\n        // Save to database\r\n        if (options.saveToDatabase && chunks) {\r\n          try {\r\n            // Delete existing chunks\r\n            await supabase\r\n              .from('document_chunks')\r\n              .delete()\r\n              .eq('file_id', file.id)\r\n            \r\n            // Insert new chunks\r\n            const chunkData = chunks.map(chunk => ({\r\n              file_id: file.id,\r\n              user_id: user.id,\r\n              chunk_index: chunk.chunkIndex,\r\n              content: chunk.content,\r\n              metadata: chunk.metadata,\r\n            }))\r\n            \r\n            await supabase\r\n              .from('document_chunks')\r\n              .insert(chunkData)\r\n            \r\n            // Update file metadata\r\n            await supabase\r\n              .from('file_metadata')\r\n              .update({\r\n                processed: true,\r\n                processing_status: 'completed',\r\n                metadata: {\r\n                  ...file.metadata,\r\n                  chunk_count: chunks.length,\r\n                  extractor_used: extractionResult.metadata.extractorUsed,\r\n                  processing_time: extractionResult.metadata.processingTime,\r\n                  word_count: extractionResult.metadata.wordCount,\r\n                  character_count: extractionResult.metadata.characterCount,\r\n                  page_count: extractionResult.metadata.pageCount,\r\n                  warnings: extractionResult.warnings,\r\n                  extracted_at: extractionResult.metadata.extractedAt,\r\n                },\r\n                updated_at: new Date().toISOString(),\r\n              })\r\n              .eq('id', file.id)\r\n            \r\n          } catch (dbError) {\r\n            console.error(`Database save error for file ${file.id}:`, dbError)\r\n            // Continue without failing the extraction\r\n          }\r\n        }\r\n        \r\n        // Add to results\r\n        const stats = getExtractionStats(extractionResult)\r\n        results.processed.push({\r\n          file_id: file.id,\r\n          file_name: file.name,\r\n          from_cache: false,\r\n          chunk_count: chunks?.length || 0,\r\n          text_length: extractionResult.text.length,\r\n          processing_time: extractionResult.metadata.processingTime,\r\n          word_count: extractionResult.metadata.wordCount,\r\n          page_count: extractionResult.metadata.pageCount,\r\n          warnings: extractionResult.warnings,\r\n          stats,\r\n        })\r\n        \r\n        results.summary.total_processing_time += extractionResult.metadata.processingTime\r\n        \r\n      } catch (error) {\r\n        console.error(`Error processing file ${file.id}:`, error)\r\n        results.failed.push({\r\n          file_id: file.id,\r\n          file_name: file.name,\r\n          error: error instanceof Error ? error.message : 'Unknown error',\r\n        })\r\n      }\r\n    }\r\n    \r\n    // Update summary\r\n    results.summary.total_processed = results.processed.length\r\n    results.summary.total_skipped = results.skipped.length\r\n    results.summary.total_failed = results.failed.length\r\n    \r\n    // Log usage\r\n    logApiUsage(user.id, '/api/extract/batch', 'batch_text_extraction', {\r\n      requested_count: file_ids.length,\r\n      processed_count: results.summary.total_processed,\r\n      skipped_count: results.summary.total_skipped,\r\n      failed_count: results.summary.total_failed,\r\n      total_processing_time: results.summary.total_processing_time,\r\n      options,\r\n    })\r\n    \r\n    return ApiResponse.success(results, \r\n      `Batch extraction completed: ${results.summary.total_processed} processed, ${results.summary.total_skipped} skipped, ${results.summary.total_failed} failed`\r\n    )\r\n    \r\n  } catch (error) {\r\n    console.error('Batch extraction handler error:', error)\r\n    return ApiResponse.internalError('Failed to process batch extraction')\r\n  }\r\n}\r\n\r\n// Export handler with middleware\r\nexport const POST = createProtectedApiHandler(batchExtractionHandler, {\r\n  rateLimit: {\r\n    ...rateLimitConfigs.embedding, // Use embedding rate limits (more restrictive)\r\n    maxRequests: 5, // Very restrictive for batch operations\r\n  },\r\n  logging: {\r\n    enabled: true,\r\n    includeBody: true,\r\n  },\r\n})"],
      names: ["POST", "batchExtractionSchema", "z", "object", "file_ids", "array", "string", "min", "max", "options", "createChunks", "boolean", "optional", "default", "maxChunkSize", "number", "saveToDatabase", "forceReprocess", "batchExtractionHandler", "request", "context", "user", "ApiResponse", "unauthorized", "body", "json", "validation", "safeParse", "success", "badRequest", "data", "supabase", "supabaseAdmin", "files", "error", "filesError", "from", "select", "eq", "id", "in", "console", "internalError", "length", "notFound", "results", "processed", "skipped", "failed", "summary", "total_requested", "total_found", "total_processed", "total_skipped", "total_failed", "total_processing_time", "file", "isSupportedMimeType", "mime_type", "push", "file_id", "file_name", "name", "reason", "existingChunks", "order", "ascending", "from_cache", "chunk_count", "text_length", "metadata", "character_count", "processing_time", "fileBuffer", "source", "path", "fileData", "downloadError", "storage", "download", "Buffer", "arrayBuffer", "extractionResult", "extractTextFromBuffer", "chunks", "createTextChunks", "text", "delete", "chunkData", "map", "chunk", "user_id", "chunk_index", "chunkIndex", "content", "insert", "update", "processing_status", "extractor_used", "extractorUsed", "processingTime", "word_count", "wordCount", "characterCount", "page_count", "pageCount", "warnings", "extracted_at", "extractedAt", "updated_at", "Date", "toISOString", "dbError", "stats", "getExtractionStats", "Error", "message", "logApiUsage", "requested_count", "processed_count", "skipped_count", "failed_count", "createProtectedApiHandler", "rateLimit", "rateLimitConfigs", "embedding", "maxRequests", "logging", "enabled", "includeBody"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "ff444478db98c491d898372e0b71ae95f5ac88e3"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1lthomjlde = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1lthomjlde();
cov_1lthomjlde().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_1lthomjlde().s[1]++;
Object.defineProperty(exports, "POST", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_1lthomjlde().f[0]++;
    cov_1lthomjlde().s[2]++;
    return POST;
  }
});
const _apimiddleware =
/* istanbul ignore next */
(cov_1lthomjlde().s[3]++, require("../../../lib/api-middleware"));
const _apiutils =
/* istanbul ignore next */
(cov_1lthomjlde().s[4]++, require("../../../lib/api-utils"));
const _ratelimit =
/* istanbul ignore next */
(cov_1lthomjlde().s[5]++, require("../../../lib/rate-limit"));
const _supabase =
/* istanbul ignore next */
(cov_1lthomjlde().s[6]++, require("../../../lib/supabase"));
const _logger =
/* istanbul ignore next */
(cov_1lthomjlde().s[7]++, require("../../../lib/logger"));
const _documentextractor =
/* istanbul ignore next */
(cov_1lthomjlde().s[8]++, require("../../../lib/document-extractor"));
const _zod =
/* istanbul ignore next */
(cov_1lthomjlde().s[9]++, require("zod"));
// Validation schema
const batchExtractionSchema =
/* istanbul ignore next */
(cov_1lthomjlde().s[10]++, _zod.z.object({
  file_ids: _zod.z.array(_zod.z.string()).min(1).max(10),
  options: _zod.z.object({
    createChunks: _zod.z.boolean().optional().default(true),
    maxChunkSize: _zod.z.number().min(100).max(5000).optional().default(1000),
    saveToDatabase: _zod.z.boolean().optional().default(true),
    forceReprocess: _zod.z.boolean().optional().default(false)
  }).optional().default({})
}));
// POST /api/extract/batch - Extract text from multiple files
async function batchExtractionHandler(request, context) {
  /* istanbul ignore next */
  cov_1lthomjlde().f[1]++;
  const {
    user
  } =
  /* istanbul ignore next */
  (cov_1lthomjlde().s[11]++, context);
  /* istanbul ignore next */
  cov_1lthomjlde().s[12]++;
  if (!user) {
    /* istanbul ignore next */
    cov_1lthomjlde().b[0][0]++;
    cov_1lthomjlde().s[13]++;
    return _apiutils.ApiResponse.unauthorized('User not authenticated');
  } else
  /* istanbul ignore next */
  {
    cov_1lthomjlde().b[0][1]++;
  }
  cov_1lthomjlde().s[14]++;
  try {
    const body =
    /* istanbul ignore next */
    (cov_1lthomjlde().s[15]++, await request.json());
    const validation =
    /* istanbul ignore next */
    (cov_1lthomjlde().s[16]++, batchExtractionSchema.safeParse(body));
    /* istanbul ignore next */
    cov_1lthomjlde().s[17]++;
    if (!validation.success) {
      /* istanbul ignore next */
      cov_1lthomjlde().b[1][0]++;
      cov_1lthomjlde().s[18]++;
      return _apiutils.ApiResponse.badRequest('Invalid request data');
    } else
    /* istanbul ignore next */
    {
      cov_1lthomjlde().b[1][1]++;
    }
    const {
      file_ids,
      options
    } =
    /* istanbul ignore next */
    (cov_1lthomjlde().s[19]++, validation.data);
    const supabase =
    /* istanbul ignore next */
    (cov_1lthomjlde().s[20]++, _supabase.supabaseAdmin);
    // Get files metadata
    const {
      data: files,
      error: filesError
    } =
    /* istanbul ignore next */
    (cov_1lthomjlde().s[21]++, await supabase.from('file_metadata').select('*').eq('user_id', user.id).in('id', file_ids));
    /* istanbul ignore next */
    cov_1lthomjlde().s[22]++;
    if (filesError) {
      /* istanbul ignore next */
      cov_1lthomjlde().b[2][0]++;
      cov_1lthomjlde().s[23]++;
      console.error('Files fetch error:', filesError);
      /* istanbul ignore next */
      cov_1lthomjlde().s[24]++;
      return _apiutils.ApiResponse.internalError('Failed to fetch files');
    } else
    /* istanbul ignore next */
    {
      cov_1lthomjlde().b[2][1]++;
    }
    cov_1lthomjlde().s[25]++;
    if (
    /* istanbul ignore next */
    (cov_1lthomjlde().b[4][0]++, !files) ||
    /* istanbul ignore next */
    (cov_1lthomjlde().b[4][1]++, files.length === 0)) {
      /* istanbul ignore next */
      cov_1lthomjlde().b[3][0]++;
      cov_1lthomjlde().s[26]++;
      return _apiutils.ApiResponse.notFound('No files found');
    } else
    /* istanbul ignore next */
    {
      cov_1lthomjlde().b[3][1]++;
    }
    const results =
    /* istanbul ignore next */
    (cov_1lthomjlde().s[27]++, {
      processed: [],
      skipped: [],
      failed: [],
      summary: {
        total_requested: file_ids.length,
        total_found: files.length,
        total_processed: 0,
        total_skipped: 0,
        total_failed: 0,
        total_processing_time: 0
      }
    });
    // Process each file
    /* istanbul ignore next */
    cov_1lthomjlde().s[28]++;
    for (const file of files) {
      /* istanbul ignore next */
      cov_1lthomjlde().s[29]++;
      try {
        /* istanbul ignore next */
        cov_1lthomjlde().s[30]++;
        // Check if file type is supported
        if (!(0, _documentextractor.isSupportedMimeType)(file.mime_type)) {
          /* istanbul ignore next */
          cov_1lthomjlde().b[5][0]++;
          cov_1lthomjlde().s[31]++;
          results.skipped.push({
            file_id: file.id,
            file_name: file.name,
            reason: `File type ${file.mime_type} is not supported for text extraction`
          });
          /* istanbul ignore next */
          cov_1lthomjlde().s[32]++;
          continue;
        } else
        /* istanbul ignore next */
        {
          cov_1lthomjlde().b[5][1]++;
        }
        // Check if already processed and not forcing reprocess
        cov_1lthomjlde().s[33]++;
        if (
        /* istanbul ignore next */
        (cov_1lthomjlde().b[7][0]++, file.processed) &&
        /* istanbul ignore next */
        (cov_1lthomjlde().b[7][1]++, !options.forceReprocess)) {
          /* istanbul ignore next */
          cov_1lthomjlde().b[6][0]++;
          // Get existing chunks
          const {
            data: existingChunks
          } =
          /* istanbul ignore next */
          (cov_1lthomjlde().s[34]++, await supabase.from('document_chunks').select('*').eq('file_id', file.id).order('chunk_index', {
            ascending: true
          }));
          /* istanbul ignore next */
          cov_1lthomjlde().s[35]++;
          if (
          /* istanbul ignore next */
          (cov_1lthomjlde().b[9][0]++, existingChunks) &&
          /* istanbul ignore next */
          (cov_1lthomjlde().b[9][1]++, existingChunks.length > 0)) {
            /* istanbul ignore next */
            cov_1lthomjlde().b[8][0]++;
            cov_1lthomjlde().s[36]++;
            results.processed.push({
              file_id: file.id,
              file_name: file.name,
              from_cache: true,
              chunk_count: existingChunks.length,
              text_length:
              /* istanbul ignore next */
              (cov_1lthomjlde().b[10][0]++, file.metadata?.character_count) ||
              /* istanbul ignore next */
              (cov_1lthomjlde().b[10][1]++, 0),
              processing_time: 0
            });
            /* istanbul ignore next */
            cov_1lthomjlde().s[37]++;
            continue;
          } else
          /* istanbul ignore next */
          {
            cov_1lthomjlde().b[8][1]++;
          }
        } else
        /* istanbul ignore next */
        {
          cov_1lthomjlde().b[6][1]++;
        }
        // Download file
        let fileBuffer;
        /* istanbul ignore next */
        cov_1lthomjlde().s[38]++;
        if (
        /* istanbul ignore next */
        (cov_1lthomjlde().b[12][0]++, file.source === 'upload') &&
        /* istanbul ignore next */
        (cov_1lthomjlde().b[12][1]++, file.path)) {
          /* istanbul ignore next */
          cov_1lthomjlde().b[11][0]++;
          const {
            data: fileData,
            error: downloadError
          } =
          /* istanbul ignore next */
          (cov_1lthomjlde().s[39]++, await supabase.storage.from('documents').download(file.path));
          /* istanbul ignore next */
          cov_1lthomjlde().s[40]++;
          if (
          /* istanbul ignore next */
          (cov_1lthomjlde().b[14][0]++, downloadError) ||
          /* istanbul ignore next */
          (cov_1lthomjlde().b[14][1]++, !fileData)) {
            /* istanbul ignore next */
            cov_1lthomjlde().b[13][0]++;
            cov_1lthomjlde().s[41]++;
            results.failed.push({
              file_id: file.id,
              file_name: file.name,
              error: 'Failed to download file'
            });
            /* istanbul ignore next */
            cov_1lthomjlde().s[42]++;
            continue;
          } else
          /* istanbul ignore next */
          {
            cov_1lthomjlde().b[13][1]++;
          }
          cov_1lthomjlde().s[43]++;
          fileBuffer = Buffer.from(await fileData.arrayBuffer());
        } else {
          /* istanbul ignore next */
          cov_1lthomjlde().b[11][1]++;
          cov_1lthomjlde().s[44]++;
          results.skipped.push({
            file_id: file.id,
            file_name: file.name,
            reason: 'Cloud storage files not yet supported for batch extraction'
          });
          /* istanbul ignore next */
          cov_1lthomjlde().s[45]++;
          continue;
        }
        // Extract text
        const extractionResult =
        /* istanbul ignore next */
        (cov_1lthomjlde().s[46]++, await (0, _documentextractor.extractTextFromBuffer)(fileBuffer, file.mime_type, file.name));
        // Create chunks
        let chunks =
        /* istanbul ignore next */
        (cov_1lthomjlde().s[47]++, null);
        /* istanbul ignore next */
        cov_1lthomjlde().s[48]++;
        if (options.createChunks) {
          /* istanbul ignore next */
          cov_1lthomjlde().b[15][0]++;
          cov_1lthomjlde().s[49]++;
          chunks = (0, _documentextractor.createTextChunks)(extractionResult.text, file.id, file.name, file.mime_type, options.maxChunkSize);
        } else
        /* istanbul ignore next */
        {
          cov_1lthomjlde().b[15][1]++;
        }
        // Save to database
        cov_1lthomjlde().s[50]++;
        if (
        /* istanbul ignore next */
        (cov_1lthomjlde().b[17][0]++, options.saveToDatabase) &&
        /* istanbul ignore next */
        (cov_1lthomjlde().b[17][1]++, chunks)) {
          /* istanbul ignore next */
          cov_1lthomjlde().b[16][0]++;
          cov_1lthomjlde().s[51]++;
          try {
            /* istanbul ignore next */
            cov_1lthomjlde().s[52]++;
            // Delete existing chunks
            await supabase.from('document_chunks').delete().eq('file_id', file.id);
            // Insert new chunks
            const chunkData =
            /* istanbul ignore next */
            (cov_1lthomjlde().s[53]++, chunks.map(chunk => {
              /* istanbul ignore next */
              cov_1lthomjlde().f[2]++;
              cov_1lthomjlde().s[54]++;
              return {
                file_id: file.id,
                user_id: user.id,
                chunk_index: chunk.chunkIndex,
                content: chunk.content,
                metadata: chunk.metadata
              };
            }));
            /* istanbul ignore next */
            cov_1lthomjlde().s[55]++;
            await supabase.from('document_chunks').insert(chunkData);
            // Update file metadata
            /* istanbul ignore next */
            cov_1lthomjlde().s[56]++;
            await supabase.from('file_metadata').update({
              processed: true,
              processing_status: 'completed',
              metadata: {
                ...file.metadata,
                chunk_count: chunks.length,
                extractor_used: extractionResult.metadata.extractorUsed,
                processing_time: extractionResult.metadata.processingTime,
                word_count: extractionResult.metadata.wordCount,
                character_count: extractionResult.metadata.characterCount,
                page_count: extractionResult.metadata.pageCount,
                warnings: extractionResult.warnings,
                extracted_at: extractionResult.metadata.extractedAt
              },
              updated_at: new Date().toISOString()
            }).eq('id', file.id);
          } catch (dbError) {
            /* istanbul ignore next */
            cov_1lthomjlde().s[57]++;
            console.error(`Database save error for file ${file.id}:`, dbError);
            // Continue without failing the extraction
          }
        } else
        /* istanbul ignore next */
        {
          cov_1lthomjlde().b[16][1]++;
        }
        // Add to results
        const stats =
        /* istanbul ignore next */
        (cov_1lthomjlde().s[58]++, (0, _documentextractor.getExtractionStats)(extractionResult));
        /* istanbul ignore next */
        cov_1lthomjlde().s[59]++;
        results.processed.push({
          file_id: file.id,
          file_name: file.name,
          from_cache: false,
          chunk_count:
          /* istanbul ignore next */
          (cov_1lthomjlde().b[18][0]++, chunks?.length) ||
          /* istanbul ignore next */
          (cov_1lthomjlde().b[18][1]++, 0),
          text_length: extractionResult.text.length,
          processing_time: extractionResult.metadata.processingTime,
          word_count: extractionResult.metadata.wordCount,
          page_count: extractionResult.metadata.pageCount,
          warnings: extractionResult.warnings,
          stats
        });
        /* istanbul ignore next */
        cov_1lthomjlde().s[60]++;
        results.summary.total_processing_time += extractionResult.metadata.processingTime;
      } catch (error) {
        /* istanbul ignore next */
        cov_1lthomjlde().s[61]++;
        console.error(`Error processing file ${file.id}:`, error);
        /* istanbul ignore next */
        cov_1lthomjlde().s[62]++;
        results.failed.push({
          file_id: file.id,
          file_name: file.name,
          error: error instanceof Error ?
          /* istanbul ignore next */
          (cov_1lthomjlde().b[19][0]++, error.message) :
          /* istanbul ignore next */
          (cov_1lthomjlde().b[19][1]++, 'Unknown error')
        });
      }
    }
    // Update summary
    /* istanbul ignore next */
    cov_1lthomjlde().s[63]++;
    results.summary.total_processed = results.processed.length;
    /* istanbul ignore next */
    cov_1lthomjlde().s[64]++;
    results.summary.total_skipped = results.skipped.length;
    /* istanbul ignore next */
    cov_1lthomjlde().s[65]++;
    results.summary.total_failed = results.failed.length;
    // Log usage
    /* istanbul ignore next */
    cov_1lthomjlde().s[66]++;
    (0, _logger.logApiUsage)(user.id, '/api/extract/batch', 'batch_text_extraction', {
      requested_count: file_ids.length,
      processed_count: results.summary.total_processed,
      skipped_count: results.summary.total_skipped,
      failed_count: results.summary.total_failed,
      total_processing_time: results.summary.total_processing_time,
      options
    });
    /* istanbul ignore next */
    cov_1lthomjlde().s[67]++;
    return _apiutils.ApiResponse.success(results, `Batch extraction completed: ${results.summary.total_processed} processed, ${results.summary.total_skipped} skipped, ${results.summary.total_failed} failed`);
  } catch (error) {
    /* istanbul ignore next */
    cov_1lthomjlde().s[68]++;
    console.error('Batch extraction handler error:', error);
    /* istanbul ignore next */
    cov_1lthomjlde().s[69]++;
    return _apiutils.ApiResponse.internalError('Failed to process batch extraction');
  }
}
const POST =
/* istanbul ignore next */
(cov_1lthomjlde().s[70]++, (0, _apimiddleware.createProtectedApiHandler)(batchExtractionHandler, {
  rateLimit: {
    ..._ratelimit.rateLimitConfigs.embedding,
    maxRequests: 5
  },
  logging: {
    enabled: true,
    includeBody: true
  }
}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQT1NUIiwiYmF0Y2hFeHRyYWN0aW9uU2NoZW1hIiwiY292XzFsdGhvbWpsZGUiLCJzIiwiX3pvZCIsInoiLCJvYmplY3QiLCJmaWxlX2lkcyIsImFycmF5Iiwic3RyaW5nIiwibWluIiwibWF4Iiwib3B0aW9ucyIsImNyZWF0ZUNodW5rcyIsImJvb2xlYW4iLCJvcHRpb25hbCIsImRlZmF1bHQiLCJtYXhDaHVua1NpemUiLCJudW1iZXIiLCJzYXZlVG9EYXRhYmFzZSIsImZvcmNlUmVwcm9jZXNzIiwiYmF0Y2hFeHRyYWN0aW9uSGFuZGxlciIsInJlcXVlc3QiLCJjb250ZXh0IiwiZiIsInVzZXIiLCJiIiwiX2FwaXV0aWxzIiwiQXBpUmVzcG9uc2UiLCJ1bmF1dGhvcml6ZWQiLCJib2R5IiwianNvbiIsInZhbGlkYXRpb24iLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwiYmFkUmVxdWVzdCIsImRhdGEiLCJzdXBhYmFzZSIsIl9zdXBhYmFzZSIsInN1cGFiYXNlQWRtaW4iLCJmaWxlcyIsImVycm9yIiwiZmlsZXNFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsImlkIiwiaW4iLCJjb25zb2xlIiwiaW50ZXJuYWxFcnJvciIsImxlbmd0aCIsIm5vdEZvdW5kIiwicmVzdWx0cyIsInByb2Nlc3NlZCIsInNraXBwZWQiLCJmYWlsZWQiLCJzdW1tYXJ5IiwidG90YWxfcmVxdWVzdGVkIiwidG90YWxfZm91bmQiLCJ0b3RhbF9wcm9jZXNzZWQiLCJ0b3RhbF9za2lwcGVkIiwidG90YWxfZmFpbGVkIiwidG90YWxfcHJvY2Vzc2luZ190aW1lIiwiZmlsZSIsIl9kb2N1bWVudGV4dHJhY3RvciIsImlzU3VwcG9ydGVkTWltZVR5cGUiLCJtaW1lX3R5cGUiLCJwdXNoIiwiZmlsZV9pZCIsImZpbGVfbmFtZSIsIm5hbWUiLCJyZWFzb24iLCJleGlzdGluZ0NodW5rcyIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZnJvbV9jYWNoZSIsImNodW5rX2NvdW50IiwidGV4dF9sZW5ndGgiLCJtZXRhZGF0YSIsImNoYXJhY3Rlcl9jb3VudCIsInByb2Nlc3NpbmdfdGltZSIsImZpbGVCdWZmZXIiLCJzb3VyY2UiLCJwYXRoIiwiZmlsZURhdGEiLCJkb3dubG9hZEVycm9yIiwic3RvcmFnZSIsImRvd25sb2FkIiwiQnVmZmVyIiwiYXJyYXlCdWZmZXIiLCJleHRyYWN0aW9uUmVzdWx0IiwiZXh0cmFjdFRleHRGcm9tQnVmZmVyIiwiY2h1bmtzIiwiY3JlYXRlVGV4dENodW5rcyIsInRleHQiLCJkZWxldGUiLCJjaHVua0RhdGEiLCJtYXAiLCJjaHVuayIsInVzZXJfaWQiLCJjaHVua19pbmRleCIsImNodW5rSW5kZXgiLCJjb250ZW50IiwiaW5zZXJ0IiwidXBkYXRlIiwicHJvY2Vzc2luZ19zdGF0dXMiLCJleHRyYWN0b3JfdXNlZCIsImV4dHJhY3RvclVzZWQiLCJwcm9jZXNzaW5nVGltZSIsIndvcmRfY291bnQiLCJ3b3JkQ291bnQiLCJjaGFyYWN0ZXJDb3VudCIsInBhZ2VfY291bnQiLCJwYWdlQ291bnQiLCJ3YXJuaW5ncyIsImV4dHJhY3RlZF9hdCIsImV4dHJhY3RlZEF0IiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImRiRXJyb3IiLCJzdGF0cyIsImdldEV4dHJhY3Rpb25TdGF0cyIsIkVycm9yIiwibWVzc2FnZSIsIl9sb2dnZXIiLCJsb2dBcGlVc2FnZSIsInJlcXVlc3RlZF9jb3VudCIsInByb2Nlc3NlZF9jb3VudCIsInNraXBwZWRfY291bnQiLCJmYWlsZWRfY291bnQiLCJfYXBpbWlkZGxld2FyZSIsImNyZWF0ZVByb3RlY3RlZEFwaUhhbmRsZXIiLCJyYXRlTGltaXQiLCJfcmF0ZWxpbWl0IiwicmF0ZUxpbWl0Q29uZmlncyIsImVtYmVkZGluZyIsIm1heFJlcXVlc3RzIiwibG9nZ2luZyIsImVuYWJsZWQiLCJpbmNsdWRlQm9keSJdLCJzb3VyY2VzIjpbIlI6XFxBcHBzXFxCcmllZmx5X0Nsb3VkXFxicmllZmx5LWNsb3VkLW5leHRqc1xcc3JjXFxhcHBcXGFwaVxcZXh0cmFjdFxcYmF0Y2hcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQgeyBjcmVhdGVQcm90ZWN0ZWRBcGlIYW5kbGVyLCBBcGlDb250ZXh0IH0gZnJvbSAnQC9hcHAvbGliL2FwaS1taWRkbGV3YXJlJ1xyXG5pbXBvcnQgeyBBcGlSZXNwb25zZSB9IGZyb20gJ0AvYXBwL2xpYi9hcGktdXRpbHMnXHJcbmltcG9ydCB7IHJhdGVMaW1pdENvbmZpZ3MgfSBmcm9tICdAL2FwcC9saWIvcmF0ZS1saW1pdCdcclxuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvYXBwL2xpYi9zdXBhYmFzZSdcclxuaW1wb3J0IHsgbG9nQXBpVXNhZ2UgfSBmcm9tICdAL2FwcC9saWIvbG9nZ2VyJ1xyXG5pbXBvcnQgeyBcclxuICBleHRyYWN0VGV4dEZyb21CdWZmZXIsIFxyXG4gIGNyZWF0ZVRleHRDaHVua3MsIFxyXG4gIGlzU3VwcG9ydGVkTWltZVR5cGUsXHJcbiAgZ2V0RXh0cmFjdGlvblN0YXRzIFxyXG59IGZyb20gJ0AvYXBwL2xpYi9kb2N1bWVudC1leHRyYWN0b3InXHJcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnXHJcblxyXG4vLyBWYWxpZGF0aW9uIHNjaGVtYVxyXG5jb25zdCBiYXRjaEV4dHJhY3Rpb25TY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgZmlsZV9pZHM6IHouYXJyYXkoei5zdHJpbmcoKSkubWluKDEpLm1heCgxMCksIC8vIExpbWl0IHRvIDEwIGZpbGVzIGF0IG9uY2VcclxuICBvcHRpb25zOiB6Lm9iamVjdCh7XHJcbiAgICBjcmVhdGVDaHVua3M6IHouYm9vbGVhbigpLm9wdGlvbmFsKCkuZGVmYXVsdCh0cnVlKSxcclxuICAgIG1heENodW5rU2l6ZTogei5udW1iZXIoKS5taW4oMTAwKS5tYXgoNTAwMCkub3B0aW9uYWwoKS5kZWZhdWx0KDEwMDApLFxyXG4gICAgc2F2ZVRvRGF0YWJhc2U6IHouYm9vbGVhbigpLm9wdGlvbmFsKCkuZGVmYXVsdCh0cnVlKSxcclxuICAgIGZvcmNlUmVwcm9jZXNzOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLmRlZmF1bHQoZmFsc2UpLFxyXG4gIH0pLm9wdGlvbmFsKCkuZGVmYXVsdCh7fSksXHJcbn0pXHJcblxyXG4vLyBQT1NUIC9hcGkvZXh0cmFjdC9iYXRjaCAtIEV4dHJhY3QgdGV4dCBmcm9tIG11bHRpcGxlIGZpbGVzXHJcbmFzeW5jIGZ1bmN0aW9uIGJhdGNoRXh0cmFjdGlvbkhhbmRsZXIocmVxdWVzdDogUmVxdWVzdCwgY29udGV4dDogQXBpQ29udGV4dCk6IFByb21pc2U8TmV4dFJlc3BvbnNlPiB7XHJcbiAgY29uc3QgeyB1c2VyIH0gPSBjb250ZXh0XHJcbiAgXHJcbiAgaWYgKCF1c2VyKSB7XHJcbiAgICByZXR1cm4gQXBpUmVzcG9uc2UudW5hdXRob3JpemVkKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkJylcclxuICB9XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IGJhdGNoRXh0cmFjdGlvblNjaGVtYS5zYWZlUGFyc2UoYm9keSlcclxuICAgIFxyXG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcclxuICAgICAgcmV0dXJuIEFwaVJlc3BvbnNlLmJhZFJlcXVlc3QoJ0ludmFsaWQgcmVxdWVzdCBkYXRhJylcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgeyBmaWxlX2lkcywgb3B0aW9ucyB9ID0gdmFsaWRhdGlvbi5kYXRhXHJcbiAgICBcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gc3VwYWJhc2VBZG1pblxyXG4gICAgXHJcbiAgICAvLyBHZXQgZmlsZXMgbWV0YWRhdGFcclxuICAgIGNvbnN0IHsgZGF0YTogZmlsZXMsIGVycm9yOiBmaWxlc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnZmlsZV9tZXRhZGF0YScpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxyXG4gICAgICAuaW4oJ2lkJywgZmlsZV9pZHMpXHJcbiAgICBcclxuICAgIGlmIChmaWxlc0Vycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZpbGVzIGZldGNoIGVycm9yOicsIGZpbGVzRXJyb3IpXHJcbiAgICAgIHJldHVybiBBcGlSZXNwb25zZS5pbnRlcm5hbEVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggZmlsZXMnKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gQXBpUmVzcG9uc2Uubm90Rm91bmQoJ05vIGZpbGVzIGZvdW5kJylcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcmVzdWx0cyA9IHtcclxuICAgICAgcHJvY2Vzc2VkOiBbXSBhcyBhbnlbXSxcclxuICAgICAgc2tpcHBlZDogW10gYXMgYW55W10sXHJcbiAgICAgIGZhaWxlZDogW10gYXMgYW55W10sXHJcbiAgICAgIHN1bW1hcnk6IHtcclxuICAgICAgICB0b3RhbF9yZXF1ZXN0ZWQ6IGZpbGVfaWRzLmxlbmd0aCxcclxuICAgICAgICB0b3RhbF9mb3VuZDogZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgIHRvdGFsX3Byb2Nlc3NlZDogMCxcclxuICAgICAgICB0b3RhbF9za2lwcGVkOiAwLFxyXG4gICAgICAgIHRvdGFsX2ZhaWxlZDogMCxcclxuICAgICAgICB0b3RhbF9wcm9jZXNzaW5nX3RpbWU6IDAsXHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb2Nlc3MgZWFjaCBmaWxlXHJcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBDaGVjayBpZiBmaWxlIHR5cGUgaXMgc3VwcG9ydGVkXHJcbiAgICAgICAgaWYgKCFpc1N1cHBvcnRlZE1pbWVUeXBlKGZpbGUubWltZV90eXBlKSkge1xyXG4gICAgICAgICAgcmVzdWx0cy5za2lwcGVkLnB1c2goe1xyXG4gICAgICAgICAgICBmaWxlX2lkOiBmaWxlLmlkLFxyXG4gICAgICAgICAgICBmaWxlX25hbWU6IGZpbGUubmFtZSxcclxuICAgICAgICAgICAgcmVhc29uOiBgRmlsZSB0eXBlICR7ZmlsZS5taW1lX3R5cGV9IGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHRleHQgZXh0cmFjdGlvbmAsXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgY29udGludWVcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYWxyZWFkeSBwcm9jZXNzZWQgYW5kIG5vdCBmb3JjaW5nIHJlcHJvY2Vzc1xyXG4gICAgICAgIGlmIChmaWxlLnByb2Nlc3NlZCAmJiAhb3B0aW9ucy5mb3JjZVJlcHJvY2Vzcykge1xyXG4gICAgICAgICAgLy8gR2V0IGV4aXN0aW5nIGNodW5rc1xyXG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ0NodW5rcyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgICAgLmZyb20oJ2RvY3VtZW50X2NodW5rcycpXHJcbiAgICAgICAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAgICAgICAuZXEoJ2ZpbGVfaWQnLCBmaWxlLmlkKVxyXG4gICAgICAgICAgICAub3JkZXIoJ2NodW5rX2luZGV4JywgeyBhc2NlbmRpbmc6IHRydWUgfSlcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKGV4aXN0aW5nQ2h1bmtzICYmIGV4aXN0aW5nQ2h1bmtzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5wcm9jZXNzZWQucHVzaCh7XHJcbiAgICAgICAgICAgICAgZmlsZV9pZDogZmlsZS5pZCxcclxuICAgICAgICAgICAgICBmaWxlX25hbWU6IGZpbGUubmFtZSxcclxuICAgICAgICAgICAgICBmcm9tX2NhY2hlOiB0cnVlLFxyXG4gICAgICAgICAgICAgIGNodW5rX2NvdW50OiBleGlzdGluZ0NodW5rcy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgdGV4dF9sZW5ndGg6IGZpbGUubWV0YWRhdGE/LmNoYXJhY3Rlcl9jb3VudCB8fCAwLFxyXG4gICAgICAgICAgICAgIHByb2Nlc3NpbmdfdGltZTogMCxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRG93bmxvYWQgZmlsZVxyXG4gICAgICAgIGxldCBmaWxlQnVmZmVyOiBCdWZmZXJcclxuICAgICAgICBcclxuICAgICAgICBpZiAoZmlsZS5zb3VyY2UgPT09ICd1cGxvYWQnICYmIGZpbGUucGF0aCkge1xyXG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBmaWxlRGF0YSwgZXJyb3I6IGRvd25sb2FkRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnN0b3JhZ2VcclxuICAgICAgICAgICAgLmZyb20oJ2RvY3VtZW50cycpXHJcbiAgICAgICAgICAgIC5kb3dubG9hZChmaWxlLnBhdGgpXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChkb3dubG9hZEVycm9yIHx8ICFmaWxlRGF0YSkge1xyXG4gICAgICAgICAgICByZXN1bHRzLmZhaWxlZC5wdXNoKHtcclxuICAgICAgICAgICAgICBmaWxlX2lkOiBmaWxlLmlkLFxyXG4gICAgICAgICAgICAgIGZpbGVfbmFtZTogZmlsZS5uYW1lLFxyXG4gICAgICAgICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGRvd25sb2FkIGZpbGUnLFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBmaWxlQnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgZmlsZURhdGEuYXJyYXlCdWZmZXIoKSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzdWx0cy5za2lwcGVkLnB1c2goe1xyXG4gICAgICAgICAgICBmaWxlX2lkOiBmaWxlLmlkLFxyXG4gICAgICAgICAgICBmaWxlX25hbWU6IGZpbGUubmFtZSxcclxuICAgICAgICAgICAgcmVhc29uOiAnQ2xvdWQgc3RvcmFnZSBmaWxlcyBub3QgeWV0IHN1cHBvcnRlZCBmb3IgYmF0Y2ggZXh0cmFjdGlvbicsXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgY29udGludWVcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRXh0cmFjdCB0ZXh0XHJcbiAgICAgICAgY29uc3QgZXh0cmFjdGlvblJlc3VsdCA9IGF3YWl0IGV4dHJhY3RUZXh0RnJvbUJ1ZmZlcihmaWxlQnVmZmVyLCBmaWxlLm1pbWVfdHlwZSwgZmlsZS5uYW1lKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSBjaHVua3NcclxuICAgICAgICBsZXQgY2h1bmtzID0gbnVsbFxyXG4gICAgICAgIGlmIChvcHRpb25zLmNyZWF0ZUNodW5rcykge1xyXG4gICAgICAgICAgY2h1bmtzID0gY3JlYXRlVGV4dENodW5rcyhcclxuICAgICAgICAgICAgZXh0cmFjdGlvblJlc3VsdC50ZXh0LFxyXG4gICAgICAgICAgICBmaWxlLmlkLFxyXG4gICAgICAgICAgICBmaWxlLm5hbWUsXHJcbiAgICAgICAgICAgIGZpbGUubWltZV90eXBlLFxyXG4gICAgICAgICAgICBvcHRpb25zLm1heENodW5rU2l6ZVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBTYXZlIHRvIGRhdGFiYXNlXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuc2F2ZVRvRGF0YWJhc2UgJiYgY2h1bmtzKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBEZWxldGUgZXhpc3RpbmcgY2h1bmtzXHJcbiAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgLmZyb20oJ2RvY3VtZW50X2NodW5rcycpXHJcbiAgICAgICAgICAgICAgLmRlbGV0ZSgpXHJcbiAgICAgICAgICAgICAgLmVxKCdmaWxlX2lkJywgZmlsZS5pZClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEluc2VydCBuZXcgY2h1bmtzXHJcbiAgICAgICAgICAgIGNvbnN0IGNodW5rRGF0YSA9IGNodW5rcy5tYXAoY2h1bmsgPT4gKHtcclxuICAgICAgICAgICAgICBmaWxlX2lkOiBmaWxlLmlkLFxyXG4gICAgICAgICAgICAgIHVzZXJfaWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgICAgY2h1bmtfaW5kZXg6IGNodW5rLmNodW5rSW5kZXgsXHJcbiAgICAgICAgICAgICAgY29udGVudDogY2h1bmsuY29udGVudCxcclxuICAgICAgICAgICAgICBtZXRhZGF0YTogY2h1bmsubWV0YWRhdGEsXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgICAgICAuZnJvbSgnZG9jdW1lbnRfY2h1bmtzJylcclxuICAgICAgICAgICAgICAuaW5zZXJ0KGNodW5rRGF0YSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBmaWxlIG1ldGFkYXRhXHJcbiAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgLmZyb20oJ2ZpbGVfbWV0YWRhdGEnKVxyXG4gICAgICAgICAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgcHJvY2Vzc2luZ19zdGF0dXM6ICdjb21wbGV0ZWQnLFxyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgLi4uZmlsZS5tZXRhZGF0YSxcclxuICAgICAgICAgICAgICAgICAgY2h1bmtfY291bnQ6IGNodW5rcy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgIGV4dHJhY3Rvcl91c2VkOiBleHRyYWN0aW9uUmVzdWx0Lm1ldGFkYXRhLmV4dHJhY3RvclVzZWQsXHJcbiAgICAgICAgICAgICAgICAgIHByb2Nlc3NpbmdfdGltZTogZXh0cmFjdGlvblJlc3VsdC5tZXRhZGF0YS5wcm9jZXNzaW5nVGltZSxcclxuICAgICAgICAgICAgICAgICAgd29yZF9jb3VudDogZXh0cmFjdGlvblJlc3VsdC5tZXRhZGF0YS53b3JkQ291bnQsXHJcbiAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlcl9jb3VudDogZXh0cmFjdGlvblJlc3VsdC5tZXRhZGF0YS5jaGFyYWN0ZXJDb3VudCxcclxuICAgICAgICAgICAgICAgICAgcGFnZV9jb3VudDogZXh0cmFjdGlvblJlc3VsdC5tZXRhZGF0YS5wYWdlQ291bnQsXHJcbiAgICAgICAgICAgICAgICAgIHdhcm5pbmdzOiBleHRyYWN0aW9uUmVzdWx0Lndhcm5pbmdzLFxyXG4gICAgICAgICAgICAgICAgICBleHRyYWN0ZWRfYXQ6IGV4dHJhY3Rpb25SZXN1bHQubWV0YWRhdGEuZXh0cmFjdGVkQXQsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLmVxKCdpZCcsIGZpbGUuaWQpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgfSBjYXRjaCAoZGJFcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBEYXRhYmFzZSBzYXZlIGVycm9yIGZvciBmaWxlICR7ZmlsZS5pZH06YCwgZGJFcnJvcilcclxuICAgICAgICAgICAgLy8gQ29udGludWUgd2l0aG91dCBmYWlsaW5nIHRoZSBleHRyYWN0aW9uXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCB0byByZXN1bHRzXHJcbiAgICAgICAgY29uc3Qgc3RhdHMgPSBnZXRFeHRyYWN0aW9uU3RhdHMoZXh0cmFjdGlvblJlc3VsdClcclxuICAgICAgICByZXN1bHRzLnByb2Nlc3NlZC5wdXNoKHtcclxuICAgICAgICAgIGZpbGVfaWQ6IGZpbGUuaWQsXHJcbiAgICAgICAgICBmaWxlX25hbWU6IGZpbGUubmFtZSxcclxuICAgICAgICAgIGZyb21fY2FjaGU6IGZhbHNlLFxyXG4gICAgICAgICAgY2h1bmtfY291bnQ6IGNodW5rcz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgICAgICB0ZXh0X2xlbmd0aDogZXh0cmFjdGlvblJlc3VsdC50ZXh0Lmxlbmd0aCxcclxuICAgICAgICAgIHByb2Nlc3NpbmdfdGltZTogZXh0cmFjdGlvblJlc3VsdC5tZXRhZGF0YS5wcm9jZXNzaW5nVGltZSxcclxuICAgICAgICAgIHdvcmRfY291bnQ6IGV4dHJhY3Rpb25SZXN1bHQubWV0YWRhdGEud29yZENvdW50LFxyXG4gICAgICAgICAgcGFnZV9jb3VudDogZXh0cmFjdGlvblJlc3VsdC5tZXRhZGF0YS5wYWdlQ291bnQsXHJcbiAgICAgICAgICB3YXJuaW5nczogZXh0cmFjdGlvblJlc3VsdC53YXJuaW5ncyxcclxuICAgICAgICAgIHN0YXRzLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmVzdWx0cy5zdW1tYXJ5LnRvdGFsX3Byb2Nlc3NpbmdfdGltZSArPSBleHRyYWN0aW9uUmVzdWx0Lm1ldGFkYXRhLnByb2Nlc3NpbmdUaW1lXHJcbiAgICAgICAgXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcHJvY2Vzc2luZyBmaWxlICR7ZmlsZS5pZH06YCwgZXJyb3IpXHJcbiAgICAgICAgcmVzdWx0cy5mYWlsZWQucHVzaCh7XHJcbiAgICAgICAgICBmaWxlX2lkOiBmaWxlLmlkLFxyXG4gICAgICAgICAgZmlsZV9uYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgc3VtbWFyeVxyXG4gICAgcmVzdWx0cy5zdW1tYXJ5LnRvdGFsX3Byb2Nlc3NlZCA9IHJlc3VsdHMucHJvY2Vzc2VkLmxlbmd0aFxyXG4gICAgcmVzdWx0cy5zdW1tYXJ5LnRvdGFsX3NraXBwZWQgPSByZXN1bHRzLnNraXBwZWQubGVuZ3RoXHJcbiAgICByZXN1bHRzLnN1bW1hcnkudG90YWxfZmFpbGVkID0gcmVzdWx0cy5mYWlsZWQubGVuZ3RoXHJcbiAgICBcclxuICAgIC8vIExvZyB1c2FnZVxyXG4gICAgbG9nQXBpVXNhZ2UodXNlci5pZCwgJy9hcGkvZXh0cmFjdC9iYXRjaCcsICdiYXRjaF90ZXh0X2V4dHJhY3Rpb24nLCB7XHJcbiAgICAgIHJlcXVlc3RlZF9jb3VudDogZmlsZV9pZHMubGVuZ3RoLFxyXG4gICAgICBwcm9jZXNzZWRfY291bnQ6IHJlc3VsdHMuc3VtbWFyeS50b3RhbF9wcm9jZXNzZWQsXHJcbiAgICAgIHNraXBwZWRfY291bnQ6IHJlc3VsdHMuc3VtbWFyeS50b3RhbF9za2lwcGVkLFxyXG4gICAgICBmYWlsZWRfY291bnQ6IHJlc3VsdHMuc3VtbWFyeS50b3RhbF9mYWlsZWQsXHJcbiAgICAgIHRvdGFsX3Byb2Nlc3NpbmdfdGltZTogcmVzdWx0cy5zdW1tYXJ5LnRvdGFsX3Byb2Nlc3NpbmdfdGltZSxcclxuICAgICAgb3B0aW9ucyxcclxuICAgIH0pXHJcbiAgICBcclxuICAgIHJldHVybiBBcGlSZXNwb25zZS5zdWNjZXNzKHJlc3VsdHMsIFxyXG4gICAgICBgQmF0Y2ggZXh0cmFjdGlvbiBjb21wbGV0ZWQ6ICR7cmVzdWx0cy5zdW1tYXJ5LnRvdGFsX3Byb2Nlc3NlZH0gcHJvY2Vzc2VkLCAke3Jlc3VsdHMuc3VtbWFyeS50b3RhbF9za2lwcGVkfSBza2lwcGVkLCAke3Jlc3VsdHMuc3VtbWFyeS50b3RhbF9mYWlsZWR9IGZhaWxlZGBcclxuICAgIClcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdCYXRjaCBleHRyYWN0aW9uIGhhbmRsZXIgZXJyb3I6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gQXBpUmVzcG9uc2UuaW50ZXJuYWxFcnJvcignRmFpbGVkIHRvIHByb2Nlc3MgYmF0Y2ggZXh0cmFjdGlvbicpXHJcbiAgfVxyXG59XHJcblxyXG4vLyBFeHBvcnQgaGFuZGxlciB3aXRoIG1pZGRsZXdhcmVcclxuZXhwb3J0IGNvbnN0IFBPU1QgPSBjcmVhdGVQcm90ZWN0ZWRBcGlIYW5kbGVyKGJhdGNoRXh0cmFjdGlvbkhhbmRsZXIsIHtcclxuICByYXRlTGltaXQ6IHtcclxuICAgIC4uLnJhdGVMaW1pdENvbmZpZ3MuZW1iZWRkaW5nLCAvLyBVc2UgZW1iZWRkaW5nIHJhdGUgbGltaXRzIChtb3JlIHJlc3RyaWN0aXZlKVxyXG4gICAgbWF4UmVxdWVzdHM6IDUsIC8vIFZlcnkgcmVzdHJpY3RpdmUgZm9yIGJhdGNoIG9wZXJhdGlvbnNcclxuICB9LFxyXG4gIGxvZ2dpbmc6IHtcclxuICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICBpbmNsdWRlQm9keTogdHJ1ZSxcclxuICB9LFxyXG59KSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsrQkE4UGE7Ozs7OztXQUFBQSxJQUFBOzs7OztrQ0E3UHlDOzs7a0NBQzFCOzs7a0NBQ0s7OztrQ0FDSDs7O2tDQUNGOzs7a0NBTXJCOzs7a0NBQ1c7QUFFbEI7QUFDQSxNQUFNQyxxQkFBQTtBQUFBO0FBQUEsQ0FBQUMsY0FBQSxHQUFBQyxDQUFBLFFBQXdCQyxJQUFBLENBQUFDLENBQUMsQ0FBQ0MsTUFBTSxDQUFDO0VBQ3JDQyxRQUFBLEVBQVVILElBQUEsQ0FBQUMsQ0FBQyxDQUFDRyxLQUFLLENBQUNKLElBQUEsQ0FBQUMsQ0FBQyxDQUFDSSxNQUFNLElBQUlDLEdBQUcsQ0FBQyxHQUFHQyxHQUFHLENBQUM7RUFDekNDLE9BQUEsRUFBU1IsSUFBQSxDQUFBQyxDQUFDLENBQUNDLE1BQU0sQ0FBQztJQUNoQk8sWUFBQSxFQUFjVCxJQUFBLENBQUFDLENBQUMsQ0FBQ1MsT0FBTyxHQUFHQyxRQUFRLEdBQUdDLE9BQU8sQ0FBQztJQUM3Q0MsWUFBQSxFQUFjYixJQUFBLENBQUFDLENBQUMsQ0FBQ2EsTUFBTSxHQUFHUixHQUFHLENBQUMsS0FBS0MsR0FBRyxDQUFDLE1BQU1JLFFBQVEsR0FBR0MsT0FBTyxDQUFDO0lBQy9ERyxjQUFBLEVBQWdCZixJQUFBLENBQUFDLENBQUMsQ0FBQ1MsT0FBTyxHQUFHQyxRQUFRLEdBQUdDLE9BQU8sQ0FBQztJQUMvQ0ksY0FBQSxFQUFnQmhCLElBQUEsQ0FBQUMsQ0FBQyxDQUFDUyxPQUFPLEdBQUdDLFFBQVEsR0FBR0MsT0FBTyxDQUFDO0VBQ2pELEdBQUdELFFBQVEsR0FBR0MsT0FBTyxDQUFDLENBQUM7QUFDekI7QUFFQTtBQUNBLGVBQWVLLHVCQUF1QkMsT0FBZ0IsRUFBRUMsT0FBbUI7RUFBQTtFQUFBckIsY0FBQSxHQUFBc0IsQ0FBQTtFQUN6RSxNQUFNO0lBQUVDO0VBQUksQ0FBRTtFQUFBO0VBQUEsQ0FBQXZCLGNBQUEsR0FBQUMsQ0FBQSxRQUFHb0IsT0FBQTtFQUFBO0VBQUFyQixjQUFBLEdBQUFDLENBQUE7RUFFakIsSUFBSSxDQUFDc0IsSUFBQSxFQUFNO0lBQUE7SUFBQXZCLGNBQUEsR0FBQXdCLENBQUE7SUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtJQUNULE9BQU93QixTQUFBLENBQUFDLFdBQVcsQ0FBQ0MsWUFBWSxDQUFDO0VBQ2xDO0VBQUE7RUFBQTtJQUFBM0IsY0FBQSxHQUFBd0IsQ0FBQTtFQUFBO0VBQUF4QixjQUFBLEdBQUFDLENBQUE7RUFFQSxJQUFJO0lBQ0YsTUFBTTJCLElBQUE7SUFBQTtJQUFBLENBQUE1QixjQUFBLEdBQUFDLENBQUEsUUFBTyxNQUFNbUIsT0FBQSxDQUFRUyxJQUFJO0lBQy9CLE1BQU1DLFVBQUE7SUFBQTtJQUFBLENBQUE5QixjQUFBLEdBQUFDLENBQUEsUUFBYUYscUJBQUEsQ0FBc0JnQyxTQUFTLENBQUNILElBQUE7SUFBQTtJQUFBNUIsY0FBQSxHQUFBQyxDQUFBO0lBRW5ELElBQUksQ0FBQzZCLFVBQUEsQ0FBV0UsT0FBTyxFQUFFO01BQUE7TUFBQWhDLGNBQUEsR0FBQXdCLENBQUE7TUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtNQUN2QixPQUFPd0IsU0FBQSxDQUFBQyxXQUFXLENBQUNPLFVBQVUsQ0FBQztJQUNoQztJQUFBO0lBQUE7TUFBQWpDLGNBQUEsR0FBQXdCLENBQUE7SUFBQTtJQUVBLE1BQU07TUFBRW5CLFFBQVE7TUFBRUs7SUFBTyxDQUFFO0lBQUE7SUFBQSxDQUFBVixjQUFBLEdBQUFDLENBQUEsUUFBRzZCLFVBQUEsQ0FBV0ksSUFBSTtJQUU3QyxNQUFNQyxRQUFBO0lBQUE7SUFBQSxDQUFBbkMsY0FBQSxHQUFBQyxDQUFBLFFBQVdtQyxTQUFBLENBQUFDLGFBQWE7SUFFOUI7SUFDQSxNQUFNO01BQUVILElBQUEsRUFBTUksS0FBSztNQUFFQyxLQUFBLEVBQU9DO0lBQVUsQ0FBRTtJQUFBO0lBQUEsQ0FBQXhDLGNBQUEsR0FBQUMsQ0FBQSxRQUFHLE1BQU1rQyxRQUFBLENBQzlDTSxJQUFJLENBQUMsaUJBQ0xDLE1BQU0sQ0FBQyxLQUNQQyxFQUFFLENBQUMsV0FBV3BCLElBQUEsQ0FBS3FCLEVBQUUsRUFDckJDLEVBQUUsQ0FBQyxNQUFNeEMsUUFBQTtJQUFBO0lBQUFMLGNBQUEsR0FBQUMsQ0FBQTtJQUVaLElBQUl1QyxVQUFBLEVBQVk7TUFBQTtNQUFBeEMsY0FBQSxHQUFBd0IsQ0FBQTtNQUFBeEIsY0FBQSxHQUFBQyxDQUFBO01BQ2Q2QyxPQUFBLENBQVFQLEtBQUssQ0FBQyxzQkFBc0JDLFVBQUE7TUFBQTtNQUFBeEMsY0FBQSxHQUFBQyxDQUFBO01BQ3BDLE9BQU93QixTQUFBLENBQUFDLFdBQVcsQ0FBQ3FCLGFBQWEsQ0FBQztJQUNuQztJQUFBO0lBQUE7TUFBQS9DLGNBQUEsR0FBQXdCLENBQUE7SUFBQTtJQUFBeEIsY0FBQSxHQUFBQyxDQUFBO0lBRUE7SUFBSTtJQUFBLENBQUFELGNBQUEsR0FBQXdCLENBQUEsV0FBQ2MsS0FBQTtJQUFBO0lBQUEsQ0FBQXRDLGNBQUEsR0FBQXdCLENBQUEsVUFBU2MsS0FBQSxDQUFNVSxNQUFNLEtBQUssSUFBRztNQUFBO01BQUFoRCxjQUFBLEdBQUF3QixDQUFBO01BQUF4QixjQUFBLEdBQUFDLENBQUE7TUFDaEMsT0FBT3dCLFNBQUEsQ0FBQUMsV0FBVyxDQUFDdUIsUUFBUSxDQUFDO0lBQzlCO0lBQUE7SUFBQTtNQUFBakQsY0FBQSxHQUFBd0IsQ0FBQTtJQUFBO0lBRUEsTUFBTTBCLE9BQUE7SUFBQTtJQUFBLENBQUFsRCxjQUFBLEdBQUFDLENBQUEsUUFBVTtNQUNka0QsU0FBQSxFQUFXLEVBQUU7TUFDYkMsT0FBQSxFQUFTLEVBQUU7TUFDWEMsTUFBQSxFQUFRLEVBQUU7TUFDVkMsT0FBQSxFQUFTO1FBQ1BDLGVBQUEsRUFBaUJsRCxRQUFBLENBQVMyQyxNQUFNO1FBQ2hDUSxXQUFBLEVBQWFsQixLQUFBLENBQU1VLE1BQU07UUFDekJTLGVBQUEsRUFBaUI7UUFDakJDLGFBQUEsRUFBZTtRQUNmQyxZQUFBLEVBQWM7UUFDZEMscUJBQUEsRUFBdUI7TUFDekI7SUFDRjtJQUVBO0lBQUE7SUFBQTVELGNBQUEsR0FBQUMsQ0FBQTtJQUNBLEtBQUssTUFBTTRELElBQUEsSUFBUXZCLEtBQUEsRUFBTztNQUFBO01BQUF0QyxjQUFBLEdBQUFDLENBQUE7TUFDeEIsSUFBSTtRQUFBO1FBQUFELGNBQUEsR0FBQUMsQ0FBQTtRQUNGO1FBQ0EsSUFBSSxDQUFDLElBQUE2RCxrQkFBQSxDQUFBQyxtQkFBbUIsRUFBQ0YsSUFBQSxDQUFLRyxTQUFTLEdBQUc7VUFBQTtVQUFBaEUsY0FBQSxHQUFBd0IsQ0FBQTtVQUFBeEIsY0FBQSxHQUFBQyxDQUFBO1VBQ3hDaUQsT0FBQSxDQUFRRSxPQUFPLENBQUNhLElBQUksQ0FBQztZQUNuQkMsT0FBQSxFQUFTTCxJQUFBLENBQUtqQixFQUFFO1lBQ2hCdUIsU0FBQSxFQUFXTixJQUFBLENBQUtPLElBQUk7WUFDcEJDLE1BQUEsRUFBUSxhQUFhUixJQUFBLENBQUtHLFNBQVM7VUFDckM7VUFBQTtVQUFBaEUsY0FBQSxHQUFBQyxDQUFBO1VBQ0E7UUFDRjtRQUFBO1FBQUE7VUFBQUQsY0FBQSxHQUFBd0IsQ0FBQTtRQUFBO1FBRUE7UUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtRQUNBO1FBQUk7UUFBQSxDQUFBRCxjQUFBLEdBQUF3QixDQUFBLFVBQUFxQyxJQUFBLENBQUtWLFNBQVM7UUFBQTtRQUFBLENBQUFuRCxjQUFBLEdBQUF3QixDQUFBLFVBQUksQ0FBQ2QsT0FBQSxDQUFRUSxjQUFjLEdBQUU7VUFBQTtVQUFBbEIsY0FBQSxHQUFBd0IsQ0FBQTtVQUM3QztVQUNBLE1BQU07WUFBRVUsSUFBQSxFQUFNb0M7VUFBYyxDQUFFO1VBQUE7VUFBQSxDQUFBdEUsY0FBQSxHQUFBQyxDQUFBLFFBQUcsTUFBTWtDLFFBQUEsQ0FDcENNLElBQUksQ0FBQyxtQkFDTEMsTUFBTSxDQUFDLEtBQ1BDLEVBQUUsQ0FBQyxXQUFXa0IsSUFBQSxDQUFLakIsRUFBRSxFQUNyQjJCLEtBQUssQ0FBQyxlQUFlO1lBQUVDLFNBQUEsRUFBVztVQUFLO1VBQUE7VUFBQXhFLGNBQUEsR0FBQUMsQ0FBQTtVQUUxQztVQUFJO1VBQUEsQ0FBQUQsY0FBQSxHQUFBd0IsQ0FBQSxVQUFBOEMsY0FBQTtVQUFBO1VBQUEsQ0FBQXRFLGNBQUEsR0FBQXdCLENBQUEsVUFBa0I4QyxjQUFBLENBQWV0QixNQUFNLEdBQUcsSUFBRztZQUFBO1lBQUFoRCxjQUFBLEdBQUF3QixDQUFBO1lBQUF4QixjQUFBLEdBQUFDLENBQUE7WUFDL0NpRCxPQUFBLENBQVFDLFNBQVMsQ0FBQ2MsSUFBSSxDQUFDO2NBQ3JCQyxPQUFBLEVBQVNMLElBQUEsQ0FBS2pCLEVBQUU7Y0FDaEJ1QixTQUFBLEVBQVdOLElBQUEsQ0FBS08sSUFBSTtjQUNwQkssVUFBQSxFQUFZO2NBQ1pDLFdBQUEsRUFBYUosY0FBQSxDQUFldEIsTUFBTTtjQUNsQzJCLFdBQUE7Y0FBYTtjQUFBLENBQUEzRSxjQUFBLEdBQUF3QixDQUFBLFdBQUFxQyxJQUFBLENBQUtlLFFBQVEsRUFBRUMsZUFBQTtjQUFBO2NBQUEsQ0FBQTdFLGNBQUEsR0FBQXdCLENBQUEsV0FBbUI7Y0FDL0NzRCxlQUFBLEVBQWlCO1lBQ25CO1lBQUE7WUFBQTlFLGNBQUEsR0FBQUMsQ0FBQTtZQUNBO1VBQ0Y7VUFBQTtVQUFBO1lBQUFELGNBQUEsR0FBQXdCLENBQUE7VUFBQTtRQUNGO1FBQUE7UUFBQTtVQUFBeEIsY0FBQSxHQUFBd0IsQ0FBQTtRQUFBO1FBRUE7UUFDQSxJQUFJdUQsVUFBQTtRQUFBO1FBQUEvRSxjQUFBLEdBQUFDLENBQUE7UUFFSjtRQUFJO1FBQUEsQ0FBQUQsY0FBQSxHQUFBd0IsQ0FBQSxXQUFBcUMsSUFBQSxDQUFLbUIsTUFBTSxLQUFLO1FBQUE7UUFBQSxDQUFBaEYsY0FBQSxHQUFBd0IsQ0FBQSxXQUFZcUMsSUFBQSxDQUFLb0IsSUFBSSxHQUFFO1VBQUE7VUFBQWpGLGNBQUEsR0FBQXdCLENBQUE7VUFDekMsTUFBTTtZQUFFVSxJQUFBLEVBQU1nRCxRQUFRO1lBQUUzQyxLQUFBLEVBQU80QztVQUFhLENBQUU7VUFBQTtVQUFBLENBQUFuRixjQUFBLEdBQUFDLENBQUEsUUFBRyxNQUFNa0MsUUFBQSxDQUFTaUQsT0FBTyxDQUNwRTNDLElBQUksQ0FBQyxhQUNMNEMsUUFBUSxDQUFDeEIsSUFBQSxDQUFLb0IsSUFBSTtVQUFBO1VBQUFqRixjQUFBLEdBQUFDLENBQUE7VUFFckI7VUFBSTtVQUFBLENBQUFELGNBQUEsR0FBQXdCLENBQUEsV0FBQTJELGFBQUE7VUFBQTtVQUFBLENBQUFuRixjQUFBLEdBQUF3QixDQUFBLFdBQWlCLENBQUMwRCxRQUFBLEdBQVU7WUFBQTtZQUFBbEYsY0FBQSxHQUFBd0IsQ0FBQTtZQUFBeEIsY0FBQSxHQUFBQyxDQUFBO1lBQzlCaUQsT0FBQSxDQUFRRyxNQUFNLENBQUNZLElBQUksQ0FBQztjQUNsQkMsT0FBQSxFQUFTTCxJQUFBLENBQUtqQixFQUFFO2NBQ2hCdUIsU0FBQSxFQUFXTixJQUFBLENBQUtPLElBQUk7Y0FDcEI3QixLQUFBLEVBQU87WUFDVDtZQUFBO1lBQUF2QyxjQUFBLEdBQUFDLENBQUE7WUFDQTtVQUNGO1VBQUE7VUFBQTtZQUFBRCxjQUFBLEdBQUF3QixDQUFBO1VBQUE7VUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtVQUVBOEUsVUFBQSxHQUFhTyxNQUFBLENBQU83QyxJQUFJLENBQUMsTUFBTXlDLFFBQUEsQ0FBU0ssV0FBVztRQUNyRCxPQUFPO1VBQUE7VUFBQXZGLGNBQUEsR0FBQXdCLENBQUE7VUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtVQUNMaUQsT0FBQSxDQUFRRSxPQUFPLENBQUNhLElBQUksQ0FBQztZQUNuQkMsT0FBQSxFQUFTTCxJQUFBLENBQUtqQixFQUFFO1lBQ2hCdUIsU0FBQSxFQUFXTixJQUFBLENBQUtPLElBQUk7WUFDcEJDLE1BQUEsRUFBUTtVQUNWO1VBQUE7VUFBQXJFLGNBQUEsR0FBQUMsQ0FBQTtVQUNBO1FBQ0Y7UUFFQTtRQUNBLE1BQU11RixnQkFBQTtRQUFBO1FBQUEsQ0FBQXhGLGNBQUEsR0FBQUMsQ0FBQSxRQUFtQixNQUFNLElBQUE2RCxrQkFBQSxDQUFBMkIscUJBQXFCLEVBQUNWLFVBQUEsRUFBWWxCLElBQUEsQ0FBS0csU0FBUyxFQUFFSCxJQUFBLENBQUtPLElBQUk7UUFFMUY7UUFDQSxJQUFJc0IsTUFBQTtRQUFBO1FBQUEsQ0FBQTFGLGNBQUEsR0FBQUMsQ0FBQSxRQUFTO1FBQUE7UUFBQUQsY0FBQSxHQUFBQyxDQUFBO1FBQ2IsSUFBSVMsT0FBQSxDQUFRQyxZQUFZLEVBQUU7VUFBQTtVQUFBWCxjQUFBLEdBQUF3QixDQUFBO1VBQUF4QixjQUFBLEdBQUFDLENBQUE7VUFDeEJ5RixNQUFBLEdBQVMsSUFBQTVCLGtCQUFBLENBQUE2QixnQkFBZ0IsRUFDdkJILGdCQUFBLENBQWlCSSxJQUFJLEVBQ3JCL0IsSUFBQSxDQUFLakIsRUFBRSxFQUNQaUIsSUFBQSxDQUFLTyxJQUFJLEVBQ1RQLElBQUEsQ0FBS0csU0FBUyxFQUNkdEQsT0FBQSxDQUFRSyxZQUFZO1FBRXhCO1FBQUE7UUFBQTtVQUFBZixjQUFBLEdBQUF3QixDQUFBO1FBQUE7UUFFQTtRQUFBeEIsY0FBQSxHQUFBQyxDQUFBO1FBQ0E7UUFBSTtRQUFBLENBQUFELGNBQUEsR0FBQXdCLENBQUEsV0FBQWQsT0FBQSxDQUFRTyxjQUFjO1FBQUE7UUFBQSxDQUFBakIsY0FBQSxHQUFBd0IsQ0FBQSxXQUFJa0UsTUFBQSxHQUFRO1VBQUE7VUFBQTFGLGNBQUEsR0FBQXdCLENBQUE7VUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtVQUNwQyxJQUFJO1lBQUE7WUFBQUQsY0FBQSxHQUFBQyxDQUFBO1lBQ0Y7WUFDQSxNQUFNa0MsUUFBQSxDQUNITSxJQUFJLENBQUMsbUJBQ0xvRCxNQUFNLEdBQ05sRCxFQUFFLENBQUMsV0FBV2tCLElBQUEsQ0FBS2pCLEVBQUU7WUFFeEI7WUFDQSxNQUFNa0QsU0FBQTtZQUFBO1lBQUEsQ0FBQTlGLGNBQUEsR0FBQUMsQ0FBQSxRQUFZeUYsTUFBQSxDQUFPSyxHQUFHLENBQUNDLEtBQUEsSUFBVTtjQUFBO2NBQUFoRyxjQUFBLEdBQUFzQixDQUFBO2NBQUF0QixjQUFBLEdBQUFDLENBQUE7Y0FBQTtnQkFDckNpRSxPQUFBLEVBQVNMLElBQUEsQ0FBS2pCLEVBQUU7Z0JBQ2hCcUQsT0FBQSxFQUFTMUUsSUFBQSxDQUFLcUIsRUFBRTtnQkFDaEJzRCxXQUFBLEVBQWFGLEtBQUEsQ0FBTUcsVUFBVTtnQkFDN0JDLE9BQUEsRUFBU0osS0FBQSxDQUFNSSxPQUFPO2dCQUN0QnhCLFFBQUEsRUFBVW9CLEtBQUEsQ0FBTXBCO2NBQ2xCO1lBQUE7WUFBQTtZQUFBNUUsY0FBQSxHQUFBQyxDQUFBO1lBRUEsTUFBTWtDLFFBQUEsQ0FDSE0sSUFBSSxDQUFDLG1CQUNMNEQsTUFBTSxDQUFDUCxTQUFBO1lBRVY7WUFBQTtZQUFBOUYsY0FBQSxHQUFBQyxDQUFBO1lBQ0EsTUFBTWtDLFFBQUEsQ0FDSE0sSUFBSSxDQUFDLGlCQUNMNkQsTUFBTSxDQUFDO2NBQ05uRCxTQUFBLEVBQVc7Y0FDWG9ELGlCQUFBLEVBQW1CO2NBQ25CM0IsUUFBQSxFQUFVO2dCQUNSLEdBQUdmLElBQUEsQ0FBS2UsUUFBUTtnQkFDaEJGLFdBQUEsRUFBYWdCLE1BQUEsQ0FBTzFDLE1BQU07Z0JBQzFCd0QsY0FBQSxFQUFnQmhCLGdCQUFBLENBQWlCWixRQUFRLENBQUM2QixhQUFhO2dCQUN2RDNCLGVBQUEsRUFBaUJVLGdCQUFBLENBQWlCWixRQUFRLENBQUM4QixjQUFjO2dCQUN6REMsVUFBQSxFQUFZbkIsZ0JBQUEsQ0FBaUJaLFFBQVEsQ0FBQ2dDLFNBQVM7Z0JBQy9DL0IsZUFBQSxFQUFpQlcsZ0JBQUEsQ0FBaUJaLFFBQVEsQ0FBQ2lDLGNBQWM7Z0JBQ3pEQyxVQUFBLEVBQVl0QixnQkFBQSxDQUFpQlosUUFBUSxDQUFDbUMsU0FBUztnQkFDL0NDLFFBQUEsRUFBVXhCLGdCQUFBLENBQWlCd0IsUUFBUTtnQkFDbkNDLFlBQUEsRUFBY3pCLGdCQUFBLENBQWlCWixRQUFRLENBQUNzQztjQUMxQztjQUNBQyxVQUFBLEVBQVksSUFBSUMsSUFBQSxHQUFPQyxXQUFXO1lBQ3BDLEdBQ0MxRSxFQUFFLENBQUMsTUFBTWtCLElBQUEsQ0FBS2pCLEVBQUU7VUFFckIsRUFBRSxPQUFPMEUsT0FBQSxFQUFTO1lBQUE7WUFBQXRILGNBQUEsR0FBQUMsQ0FBQTtZQUNoQjZDLE9BQUEsQ0FBUVAsS0FBSyxDQUFDLGdDQUFnQ3NCLElBQUEsQ0FBS2pCLEVBQUUsR0FBRyxFQUFFMEUsT0FBQTtZQUMxRDtVQUNGO1FBQ0Y7UUFBQTtRQUFBO1VBQUF0SCxjQUFBLEdBQUF3QixDQUFBO1FBQUE7UUFFQTtRQUNBLE1BQU0rRixLQUFBO1FBQUE7UUFBQSxDQUFBdkgsY0FBQSxHQUFBQyxDQUFBLFFBQVEsSUFBQTZELGtCQUFBLENBQUEwRCxrQkFBa0IsRUFBQ2hDLGdCQUFBO1FBQUE7UUFBQXhGLGNBQUEsR0FBQUMsQ0FBQTtRQUNqQ2lELE9BQUEsQ0FBUUMsU0FBUyxDQUFDYyxJQUFJLENBQUM7VUFDckJDLE9BQUEsRUFBU0wsSUFBQSxDQUFLakIsRUFBRTtVQUNoQnVCLFNBQUEsRUFBV04sSUFBQSxDQUFLTyxJQUFJO1VBQ3BCSyxVQUFBLEVBQVk7VUFDWkMsV0FBQTtVQUFhO1VBQUEsQ0FBQTFFLGNBQUEsR0FBQXdCLENBQUEsV0FBQWtFLE1BQUEsRUFBUTFDLE1BQUE7VUFBQTtVQUFBLENBQUFoRCxjQUFBLEdBQUF3QixDQUFBLFdBQVU7VUFDL0JtRCxXQUFBLEVBQWFhLGdCQUFBLENBQWlCSSxJQUFJLENBQUM1QyxNQUFNO1VBQ3pDOEIsZUFBQSxFQUFpQlUsZ0JBQUEsQ0FBaUJaLFFBQVEsQ0FBQzhCLGNBQWM7VUFDekRDLFVBQUEsRUFBWW5CLGdCQUFBLENBQWlCWixRQUFRLENBQUNnQyxTQUFTO1VBQy9DRSxVQUFBLEVBQVl0QixnQkFBQSxDQUFpQlosUUFBUSxDQUFDbUMsU0FBUztVQUMvQ0MsUUFBQSxFQUFVeEIsZ0JBQUEsQ0FBaUJ3QixRQUFRO1VBQ25DTztRQUNGO1FBQUE7UUFBQXZILGNBQUEsR0FBQUMsQ0FBQTtRQUVBaUQsT0FBQSxDQUFRSSxPQUFPLENBQUNNLHFCQUFxQixJQUFJNEIsZ0JBQUEsQ0FBaUJaLFFBQVEsQ0FBQzhCLGNBQWM7TUFFbkYsRUFBRSxPQUFPbkUsS0FBQSxFQUFPO1FBQUE7UUFBQXZDLGNBQUEsR0FBQUMsQ0FBQTtRQUNkNkMsT0FBQSxDQUFRUCxLQUFLLENBQUMseUJBQXlCc0IsSUFBQSxDQUFLakIsRUFBRSxHQUFHLEVBQUVMLEtBQUE7UUFBQTtRQUFBdkMsY0FBQSxHQUFBQyxDQUFBO1FBQ25EaUQsT0FBQSxDQUFRRyxNQUFNLENBQUNZLElBQUksQ0FBQztVQUNsQkMsT0FBQSxFQUFTTCxJQUFBLENBQUtqQixFQUFFO1VBQ2hCdUIsU0FBQSxFQUFXTixJQUFBLENBQUtPLElBQUk7VUFDcEI3QixLQUFBLEVBQU9BLEtBQUEsWUFBaUJrRixLQUFBO1VBQUE7VUFBQSxDQUFBekgsY0FBQSxHQUFBd0IsQ0FBQSxXQUFRZSxLQUFBLENBQU1tRixPQUFPO1VBQUE7VUFBQSxDQUFBMUgsY0FBQSxHQUFBd0IsQ0FBQSxXQUFHO1FBQ2xEO01BQ0Y7SUFDRjtJQUVBO0lBQUE7SUFBQXhCLGNBQUEsR0FBQUMsQ0FBQTtJQUNBaUQsT0FBQSxDQUFRSSxPQUFPLENBQUNHLGVBQWUsR0FBR1AsT0FBQSxDQUFRQyxTQUFTLENBQUNILE1BQU07SUFBQTtJQUFBaEQsY0FBQSxHQUFBQyxDQUFBO0lBQzFEaUQsT0FBQSxDQUFRSSxPQUFPLENBQUNJLGFBQWEsR0FBR1IsT0FBQSxDQUFRRSxPQUFPLENBQUNKLE1BQU07SUFBQTtJQUFBaEQsY0FBQSxHQUFBQyxDQUFBO0lBQ3REaUQsT0FBQSxDQUFRSSxPQUFPLENBQUNLLFlBQVksR0FBR1QsT0FBQSxDQUFRRyxNQUFNLENBQUNMLE1BQU07SUFFcEQ7SUFBQTtJQUFBaEQsY0FBQSxHQUFBQyxDQUFBO0lBQ0EsSUFBQTBILE9BQUEsQ0FBQUMsV0FBVyxFQUFDckcsSUFBQSxDQUFLcUIsRUFBRSxFQUFFLHNCQUFzQix5QkFBeUI7TUFDbEVpRixlQUFBLEVBQWlCeEgsUUFBQSxDQUFTMkMsTUFBTTtNQUNoQzhFLGVBQUEsRUFBaUI1RSxPQUFBLENBQVFJLE9BQU8sQ0FBQ0csZUFBZTtNQUNoRHNFLGFBQUEsRUFBZTdFLE9BQUEsQ0FBUUksT0FBTyxDQUFDSSxhQUFhO01BQzVDc0UsWUFBQSxFQUFjOUUsT0FBQSxDQUFRSSxPQUFPLENBQUNLLFlBQVk7TUFDMUNDLHFCQUFBLEVBQXVCVixPQUFBLENBQVFJLE9BQU8sQ0FBQ00scUJBQXFCO01BQzVEbEQ7SUFDRjtJQUFBO0lBQUFWLGNBQUEsR0FBQUMsQ0FBQTtJQUVBLE9BQU93QixTQUFBLENBQUFDLFdBQVcsQ0FBQ00sT0FBTyxDQUFDa0IsT0FBQSxFQUN6QiwrQkFBK0JBLE9BQUEsQ0FBUUksT0FBTyxDQUFDRyxlQUFlLGVBQWVQLE9BQUEsQ0FBUUksT0FBTyxDQUFDSSxhQUFhLGFBQWFSLE9BQUEsQ0FBUUksT0FBTyxDQUFDSyxZQUFZLFNBQVM7RUFHaEssRUFBRSxPQUFPcEIsS0FBQSxFQUFPO0lBQUE7SUFBQXZDLGNBQUEsR0FBQUMsQ0FBQTtJQUNkNkMsT0FBQSxDQUFRUCxLQUFLLENBQUMsbUNBQW1DQSxLQUFBO0lBQUE7SUFBQXZDLGNBQUEsR0FBQUMsQ0FBQTtJQUNqRCxPQUFPd0IsU0FBQSxDQUFBQyxXQUFXLENBQUNxQixhQUFhLENBQUM7RUFDbkM7QUFDRjtBQUdPLE1BQU1qRCxJQUFBO0FBQUE7QUFBQSxDQUFBRSxjQUFBLEdBQUFDLENBQUEsUUFBTyxJQUFBZ0ksY0FBQSxDQUFBQyx5QkFBeUIsRUFBQy9HLHNCQUFBLEVBQXdCO0VBQ3BFZ0gsU0FBQSxFQUFXO0lBQ1QsR0FBR0MsVUFBQSxDQUFBQyxnQkFBZ0IsQ0FBQ0MsU0FBUztJQUM3QkMsV0FBQSxFQUFhO0VBQ2Y7RUFDQUMsT0FBQSxFQUFTO0lBQ1BDLE9BQUEsRUFBUztJQUNUQyxXQUFBLEVBQWE7RUFDZjtBQUNGIiwiaWdub3JlTGlzdCI6W119