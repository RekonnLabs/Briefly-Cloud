{"version":3,"names":["cov_1qqhase94g","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","POST","_authmiddleware","withAuth","_usagemiddleware","withChatControls","request","context","user","body","json","message","conversationId","model","_server","NextResponse","success","error","status","length","_logger","logger","info","userId","id","messageLength","aiResponse","substring","response","data","messageId","Date","now","Math","random","toString","substr","userMessage","timestamp","toISOString","usage","tokensUsed","ceil","processingTime","Error","includes","upgradeRequired","retryAfter"],"sources":["R:\\Apps\\Briefly_Cloud\\briefly-cloud-nextjs\\src\\app\\api\\chat\\message\\route.ts"],"sourcesContent":["/**\r\n * Chat Message API Route\r\n * \r\n * This endpoint handles chat message processing with comprehensive\r\n * usage tracking, rate limiting, and tier enforcement.\r\n */\r\n\r\nimport { NextRequest, NextResponse } from 'next/server'\r\nimport { withAuth } from '@/app/lib/auth/auth-middleware'\r\nimport { withChatControls } from '@/app/lib/usage/usage-middleware'\r\nimport { logger } from '@/app/lib/logger'\r\nimport { createError } from '@/app/lib/api-errors'\r\n\r\n/**\r\n * POST /api/chat/message\r\n * \r\n * Process a chat message with AI response\r\n */\r\nexport const POST = withAuth(\r\n  withChatControls(async (request: NextRequest, context) => {\r\n    try {\r\n      const { user } = context\r\n      \r\n      // Parse request body\r\n      const body = await request.json()\r\n      const { message, conversationId, model = 'gpt-4-turbo' } = body\r\n      \r\n      if (!message || typeof message !== 'string') {\r\n        return NextResponse.json(\r\n          { \r\n            success: false, \r\n            error: 'Invalid message',\r\n            message: 'Message is required and must be a string'\r\n          },\r\n          { status: 400 }\r\n        )\r\n      }\r\n      \r\n      if (message.length > 4000) {\r\n        return NextResponse.json(\r\n          { \r\n            success: false, \r\n            error: 'Message too long',\r\n            message: 'Message must be less than 4000 characters'\r\n          },\r\n          { status: 400 }\r\n        )\r\n      }\r\n      \r\n      // Log the chat request\r\n      logger.info('Processing chat message', {\r\n        userId: user.id,\r\n        conversationId,\r\n        messageLength: message.length,\r\n        model\r\n      })\r\n      \r\n      // TODO: Implement actual AI chat processing\r\n      // This would integrate with OpenAI API, vector search, etc.\r\n      \r\n      // Simulate AI response for now\r\n      const aiResponse = `I received your message: \\\"${message.substring(0, 100)}${message.length > 100 ? '...' : ''}\\\"\\\\n\\\\nThis is a simulated response. The actual implementation would process your message using AI and provide a relevant response based on your documents.`\r\n      \r\n      // Create response\r\n      const response = {\r\n        success: true,\r\n        data: {\r\n          messageId: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n          conversationId: conversationId || `conv_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n          userMessage: message,\r\n          aiResponse,\r\n          model,\r\n          timestamp: new Date().toISOString(),\r\n          usage: {\r\n            tokensUsed: Math.ceil(message.length / 4) + Math.ceil(aiResponse.length / 4), // Rough estimate\r\n            processingTime: Date.now() - Date.now() // Would be actual processing time\r\n          }\r\n        }\r\n      }\r\n      \r\n      logger.info('Chat message processed successfully', {\r\n        userId: user.id,\r\n        messageId: response.data.messageId,\r\n        tokensUsed: response.data.usage.tokensUsed\r\n      })\r\n      \r\n      return NextResponse.json(response)\r\n      \r\n    } catch (error) {\r\n      logger.error('Failed to process chat message', {\r\n        userId: context.user.id,\r\n        error: (error as Error).message\r\n      })\r\n      \r\n      if (error instanceof Error) {\r\n        // Handle specific error types\r\n        if (error.message.includes('limit exceeded')) {\r\n          return NextResponse.json(\r\n            { \r\n              success: false, \r\n              error: 'Usage limit exceeded',\r\n              message: error.message,\r\n              upgradeRequired: true\r\n            },\r\n            { status: 402 }\r\n          )\r\n        }\r\n        \r\n        if (error.message.includes('rate limit')) {\r\n          return NextResponse.json(\r\n            { \r\n              success: false, \r\n              error: 'Rate limit exceeded',\r\n              message: error.message,\r\n              retryAfter: 60\r\n            },\r\n            { status: 429 }\r\n          )\r\n        }\r\n      }\r\n      \r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'Failed to process message',\r\n          message: 'Please try again later'\r\n        },\r\n        { status: 500 }\r\n      )\r\n    }\r\n  })\r\n)"],"mappings":"AAAA;;;;;GAKC;;AAAA;AAAA,SAAAA,eAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA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","ignoreList":[]}